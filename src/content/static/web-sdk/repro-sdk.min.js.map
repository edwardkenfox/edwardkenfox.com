{"version":3,"file":"repro-sdk.min.js","sources":["../node_modules/js-cookie/src/js.cookie.js","../node_modules/platform/platform.js","../src/util.js","../src/uuid.js","../src/constants.js","../src/session-manager.js","../node_modules/promise-polyfill/lib/index.js","../src/configuration.js","../src/message-manager.js","../src/clip.js","../src/main.js"],"sourcesContent":["/*!\n * JavaScript Cookie v2.2.0\n * https://github.com/js-cookie/js-cookie\n *\n * Copyright 2006, 2015 Klaus Hartl & Fagner Brack\n * Released under the MIT license\n */\n;(function (factory) {\n\tvar registeredInModuleLoader = false;\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(factory);\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (typeof exports === 'object') {\n\t\tmodule.exports = factory();\n\t\tregisteredInModuleLoader = true;\n\t}\n\tif (!registeredInModuleLoader) {\n\t\tvar OldCookies = window.Cookies;\n\t\tvar api = window.Cookies = factory();\n\t\tapi.noConflict = function () {\n\t\t\twindow.Cookies = OldCookies;\n\t\t\treturn api;\n\t\t};\n\t}\n}(function () {\n\tfunction extend () {\n\t\tvar i = 0;\n\t\tvar result = {};\n\t\tfor (; i < arguments.length; i++) {\n\t\t\tvar attributes = arguments[ i ];\n\t\t\tfor (var key in attributes) {\n\t\t\t\tresult[key] = attributes[key];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tfunction init (converter) {\n\t\tfunction api (key, value, attributes) {\n\t\t\tvar result;\n\t\t\tif (typeof document === 'undefined') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Write\n\n\t\t\tif (arguments.length > 1) {\n\t\t\t\tattributes = extend({\n\t\t\t\t\tpath: '/'\n\t\t\t\t}, api.defaults, attributes);\n\n\t\t\t\tif (typeof attributes.expires === 'number') {\n\t\t\t\t\tvar expires = new Date();\n\t\t\t\t\texpires.setMilliseconds(expires.getMilliseconds() + attributes.expires * 864e+5);\n\t\t\t\t\tattributes.expires = expires;\n\t\t\t\t}\n\n\t\t\t\t// We're using \"expires\" because \"max-age\" is not supported by IE\n\t\t\t\tattributes.expires = attributes.expires ? attributes.expires.toUTCString() : '';\n\n\t\t\t\ttry {\n\t\t\t\t\tresult = JSON.stringify(value);\n\t\t\t\t\tif (/^[\\{\\[]/.test(result)) {\n\t\t\t\t\t\tvalue = result;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\n\t\t\t\tif (!converter.write) {\n\t\t\t\t\tvalue = encodeURIComponent(String(value))\n\t\t\t\t\t\t.replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g, decodeURIComponent);\n\t\t\t\t} else {\n\t\t\t\t\tvalue = converter.write(value, key);\n\t\t\t\t}\n\n\t\t\t\tkey = encodeURIComponent(String(key));\n\t\t\t\tkey = key.replace(/%(23|24|26|2B|5E|60|7C)/g, decodeURIComponent);\n\t\t\t\tkey = key.replace(/[\\(\\)]/g, escape);\n\n\t\t\t\tvar stringifiedAttributes = '';\n\n\t\t\t\tfor (var attributeName in attributes) {\n\t\t\t\t\tif (!attributes[attributeName]) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '; ' + attributeName;\n\t\t\t\t\tif (attributes[attributeName] === true) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tstringifiedAttributes += '=' + attributes[attributeName];\n\t\t\t\t}\n\t\t\t\treturn (document.cookie = key + '=' + value + stringifiedAttributes);\n\t\t\t}\n\n\t\t\t// Read\n\n\t\t\tif (!key) {\n\t\t\t\tresult = {};\n\t\t\t}\n\n\t\t\t// To prevent the for loop in the first place assign an empty array\n\t\t\t// in case there are no cookies at all. Also prevents odd result when\n\t\t\t// calling \"get()\"\n\t\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\n\t\t\tvar rdecode = /(%[0-9A-Z]{2})+/g;\n\t\t\tvar i = 0;\n\n\t\t\tfor (; i < cookies.length; i++) {\n\t\t\t\tvar parts = cookies[i].split('=');\n\t\t\t\tvar cookie = parts.slice(1).join('=');\n\n\t\t\t\tif (!this.json && cookie.charAt(0) === '\"') {\n\t\t\t\t\tcookie = cookie.slice(1, -1);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tvar name = parts[0].replace(rdecode, decodeURIComponent);\n\t\t\t\t\tcookie = converter.read ?\n\t\t\t\t\t\tconverter.read(cookie, name) : converter(cookie, name) ||\n\t\t\t\t\t\tcookie.replace(rdecode, decodeURIComponent);\n\n\t\t\t\t\tif (this.json) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tcookie = JSON.parse(cookie);\n\t\t\t\t\t\t} catch (e) {}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (key === name) {\n\t\t\t\t\t\tresult = cookie;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!key) {\n\t\t\t\t\t\tresult[name] = cookie;\n\t\t\t\t\t}\n\t\t\t\t} catch (e) {}\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\tapi.set = api;\n\t\tapi.get = function (key) {\n\t\t\treturn api.call(api, key);\n\t\t};\n\t\tapi.getJSON = function () {\n\t\t\treturn api.apply({\n\t\t\t\tjson: true\n\t\t\t}, [].slice.call(arguments));\n\t\t};\n\t\tapi.defaults = {};\n\n\t\tapi.remove = function (key, attributes) {\n\t\t\tapi(key, '', extend(attributes, {\n\t\t\t\texpires: -1\n\t\t\t}));\n\t\t};\n\n\t\tapi.withConverter = init;\n\n\t\treturn api;\n\t}\n\n\treturn init(function () {});\n}));\n","/*!\n * Platform.js <https://mths.be/platform>\n * Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>\n * Copyright 2011-2013 John-David Dalton <http://allyoucanleet.com/>\n * Available under MIT license <https://mths.be/mit>\n */\n;(function() {\n  'use strict';\n\n  /** Used to determine if values are of the language type `Object`. */\n  var objectTypes = {\n    'function': true,\n    'object': true\n  };\n\n  /** Used as a reference to the global object. */\n  var root = (objectTypes[typeof window] && window) || this;\n\n  /** Backup possible global object. */\n  var oldRoot = root;\n\n  /** Detect free variable `exports`. */\n  var freeExports = objectTypes[typeof exports] && exports;\n\n  /** Detect free variable `module`. */\n  var freeModule = objectTypes[typeof module] && module && !module.nodeType && module;\n\n  /** Detect free variable `global` from Node.js or Browserified code and use it as `root`. */\n  var freeGlobal = freeExports && freeModule && typeof global == 'object' && global;\n  if (freeGlobal && (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal || freeGlobal.self === freeGlobal)) {\n    root = freeGlobal;\n  }\n\n  /**\n   * Used as the maximum length of an array-like object.\n   * See the [ES6 spec](http://people.mozilla.org/~jorendorff/es6-draft.html#sec-tolength)\n   * for more details.\n   */\n  var maxSafeInteger = Math.pow(2, 53) - 1;\n\n  /** Regular expression to detect Opera. */\n  var reOpera = /\\bOpera/;\n\n  /** Possible global object. */\n  var thisBinding = this;\n\n  /** Used for native method references. */\n  var objectProto = Object.prototype;\n\n  /** Used to check for own properties of an object. */\n  var hasOwnProperty = objectProto.hasOwnProperty;\n\n  /** Used to resolve the internal `[[Class]]` of values. */\n  var toString = objectProto.toString;\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Capitalizes a string value.\n   *\n   * @private\n   * @param {string} string The string to capitalize.\n   * @returns {string} The capitalized string.\n   */\n  function capitalize(string) {\n    string = String(string);\n    return string.charAt(0).toUpperCase() + string.slice(1);\n  }\n\n  /**\n   * A utility function to clean up the OS name.\n   *\n   * @private\n   * @param {string} os The OS name to clean up.\n   * @param {string} [pattern] A `RegExp` pattern matching the OS name.\n   * @param {string} [label] A label for the OS.\n   */\n  function cleanupOS(os, pattern, label) {\n    // Platform tokens are defined at:\n    // http://msdn.microsoft.com/en-us/library/ms537503(VS.85).aspx\n    // http://web.archive.org/web/20081122053950/http://msdn.microsoft.com/en-us/library/ms537503(VS.85).aspx\n    var data = {\n      '10.0': '10',\n      '6.4':  '10 Technical Preview',\n      '6.3':  '8.1',\n      '6.2':  '8',\n      '6.1':  'Server 2008 R2 / 7',\n      '6.0':  'Server 2008 / Vista',\n      '5.2':  'Server 2003 / XP 64-bit',\n      '5.1':  'XP',\n      '5.01': '2000 SP1',\n      '5.0':  '2000',\n      '4.0':  'NT',\n      '4.90': 'ME'\n    };\n    // Detect Windows version from platform tokens.\n    if (pattern && label && /^Win/i.test(os) && !/^Windows Phone /i.test(os) &&\n        (data = data[/[\\d.]+$/.exec(os)])) {\n      os = 'Windows ' + data;\n    }\n    // Correct character case and cleanup string.\n    os = String(os);\n\n    if (pattern && label) {\n      os = os.replace(RegExp(pattern, 'i'), label);\n    }\n\n    os = format(\n      os.replace(/ ce$/i, ' CE')\n        .replace(/\\bhpw/i, 'web')\n        .replace(/\\bMacintosh\\b/, 'Mac OS')\n        .replace(/_PowerPC\\b/i, ' OS')\n        .replace(/\\b(OS X) [^ \\d]+/i, '$1')\n        .replace(/\\bMac (OS X)\\b/, '$1')\n        .replace(/\\/(\\d)/, ' $1')\n        .replace(/_/g, '.')\n        .replace(/(?: BePC|[ .]*fc[ \\d.]+)$/i, '')\n        .replace(/\\bx86\\.64\\b/gi, 'x86_64')\n        .replace(/\\b(Windows Phone) OS\\b/, '$1')\n        .replace(/\\b(Chrome OS \\w+) [\\d.]+\\b/, '$1')\n        .split(' on ')[0]\n    );\n\n    return os;\n  }\n\n  /**\n   * An iteration utility for arrays and objects.\n   *\n   * @private\n   * @param {Array|Object} object The object to iterate over.\n   * @param {Function} callback The function called per iteration.\n   */\n  function each(object, callback) {\n    var index = -1,\n        length = object ? object.length : 0;\n\n    if (typeof length == 'number' && length > -1 && length <= maxSafeInteger) {\n      while (++index < length) {\n        callback(object[index], index, object);\n      }\n    } else {\n      forOwn(object, callback);\n    }\n  }\n\n  /**\n   * Trim and conditionally capitalize string values.\n   *\n   * @private\n   * @param {string} string The string to format.\n   * @returns {string} The formatted string.\n   */\n  function format(string) {\n    string = trim(string);\n    return /^(?:webOS|i(?:OS|P))/.test(string)\n      ? string\n      : capitalize(string);\n  }\n\n  /**\n   * Iterates over an object's own properties, executing the `callback` for each.\n   *\n   * @private\n   * @param {Object} object The object to iterate over.\n   * @param {Function} callback The function executed per own property.\n   */\n  function forOwn(object, callback) {\n    for (var key in object) {\n      if (hasOwnProperty.call(object, key)) {\n        callback(object[key], key, object);\n      }\n    }\n  }\n\n  /**\n   * Gets the internal `[[Class]]` of a value.\n   *\n   * @private\n   * @param {*} value The value.\n   * @returns {string} The `[[Class]]`.\n   */\n  function getClassOf(value) {\n    return value == null\n      ? capitalize(value)\n      : toString.call(value).slice(8, -1);\n  }\n\n  /**\n   * Host objects can return type values that are different from their actual\n   * data type. The objects we are concerned with usually return non-primitive\n   * types of \"object\", \"function\", or \"unknown\".\n   *\n   * @private\n   * @param {*} object The owner of the property.\n   * @param {string} property The property to check.\n   * @returns {boolean} Returns `true` if the property value is a non-primitive, else `false`.\n   */\n  function isHostType(object, property) {\n    var type = object != null ? typeof object[property] : 'number';\n    return !/^(?:boolean|number|string|undefined)$/.test(type) &&\n      (type == 'object' ? !!object[property] : true);\n  }\n\n  /**\n   * Prepares a string for use in a `RegExp` by making hyphens and spaces optional.\n   *\n   * @private\n   * @param {string} string The string to qualify.\n   * @returns {string} The qualified string.\n   */\n  function qualify(string) {\n    return String(string).replace(/([ -])(?!$)/g, '$1?');\n  }\n\n  /**\n   * A bare-bones `Array#reduce` like utility function.\n   *\n   * @private\n   * @param {Array} array The array to iterate over.\n   * @param {Function} callback The function called per iteration.\n   * @returns {*} The accumulated result.\n   */\n  function reduce(array, callback) {\n    var accumulator = null;\n    each(array, function(value, index) {\n      accumulator = callback(accumulator, value, index, array);\n    });\n    return accumulator;\n  }\n\n  /**\n   * Removes leading and trailing whitespace from a string.\n   *\n   * @private\n   * @param {string} string The string to trim.\n   * @returns {string} The trimmed string.\n   */\n  function trim(string) {\n    return String(string).replace(/^ +| +$/g, '');\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  /**\n   * Creates a new platform object.\n   *\n   * @memberOf platform\n   * @param {Object|string} [ua=navigator.userAgent] The user agent string or\n   *  context object.\n   * @returns {Object} A platform object.\n   */\n  function parse(ua) {\n\n    /** The environment context object. */\n    var context = root;\n\n    /** Used to flag when a custom context is provided. */\n    var isCustomContext = ua && typeof ua == 'object' && getClassOf(ua) != 'String';\n\n    // Juggle arguments.\n    if (isCustomContext) {\n      context = ua;\n      ua = null;\n    }\n\n    /** Browser navigator object. */\n    var nav = context.navigator || {};\n\n    /** Browser user agent string. */\n    var userAgent = nav.userAgent || '';\n\n    ua || (ua = userAgent);\n\n    /** Used to flag when `thisBinding` is the [ModuleScope]. */\n    var isModuleScope = isCustomContext || thisBinding == oldRoot;\n\n    /** Used to detect if browser is like Chrome. */\n    var likeChrome = isCustomContext\n      ? !!nav.likeChrome\n      : /\\bChrome\\b/.test(ua) && !/internal|\\n/i.test(toString.toString());\n\n    /** Internal `[[Class]]` value shortcuts. */\n    var objectClass = 'Object',\n        airRuntimeClass = isCustomContext ? objectClass : 'ScriptBridgingProxyObject',\n        enviroClass = isCustomContext ? objectClass : 'Environment',\n        javaClass = (isCustomContext && context.java) ? 'JavaPackage' : getClassOf(context.java),\n        phantomClass = isCustomContext ? objectClass : 'RuntimeObject';\n\n    /** Detect Java environments. */\n    var java = /\\bJava/.test(javaClass) && context.java;\n\n    /** Detect Rhino. */\n    var rhino = java && getClassOf(context.environment) == enviroClass;\n\n    /** A character to represent alpha. */\n    var alpha = java ? 'a' : '\\u03b1';\n\n    /** A character to represent beta. */\n    var beta = java ? 'b' : '\\u03b2';\n\n    /** Browser document object. */\n    var doc = context.document || {};\n\n    /**\n     * Detect Opera browser (Presto-based).\n     * http://www.howtocreate.co.uk/operaStuff/operaObject.html\n     * http://dev.opera.com/articles/view/opera-mini-web-content-authoring-guidelines/#operamini\n     */\n    var opera = context.operamini || context.opera;\n\n    /** Opera `[[Class]]`. */\n    var operaClass = reOpera.test(operaClass = (isCustomContext && opera) ? opera['[[Class]]'] : getClassOf(opera))\n      ? operaClass\n      : (opera = null);\n\n    /*------------------------------------------------------------------------*/\n\n    /** Temporary variable used over the script's lifetime. */\n    var data;\n\n    /** The CPU architecture. */\n    var arch = ua;\n\n    /** Platform description array. */\n    var description = [];\n\n    /** Platform alpha/beta indicator. */\n    var prerelease = null;\n\n    /** A flag to indicate that environment features should be used to resolve the platform. */\n    var useFeatures = ua == userAgent;\n\n    /** The browser/environment version. */\n    var version = useFeatures && opera && typeof opera.version == 'function' && opera.version();\n\n    /** A flag to indicate if the OS ends with \"/ Version\" */\n    var isSpecialCasedOS;\n\n    /* Detectable layout engines (order is important). */\n    var layout = getLayout([\n      { 'label': 'EdgeHTML', 'pattern': 'Edge' },\n      'Trident',\n      { 'label': 'WebKit', 'pattern': 'AppleWebKit' },\n      'iCab',\n      'Presto',\n      'NetFront',\n      'Tasman',\n      'KHTML',\n      'Gecko'\n    ]);\n\n    /* Detectable browser names (order is important). */\n    var name = getName([\n      'Adobe AIR',\n      'Arora',\n      'Avant Browser',\n      'Breach',\n      'Camino',\n      'Electron',\n      'Epiphany',\n      'Fennec',\n      'Flock',\n      'Galeon',\n      'GreenBrowser',\n      'iCab',\n      'Iceweasel',\n      'K-Meleon',\n      'Konqueror',\n      'Lunascape',\n      'Maxthon',\n      { 'label': 'Microsoft Edge', 'pattern': 'Edge' },\n      'Midori',\n      'Nook Browser',\n      'PaleMoon',\n      'PhantomJS',\n      'Raven',\n      'Rekonq',\n      'RockMelt',\n      { 'label': 'Samsung Internet', 'pattern': 'SamsungBrowser' },\n      'SeaMonkey',\n      { 'label': 'Silk', 'pattern': '(?:Cloud9|Silk-Accelerated)' },\n      'Sleipnir',\n      'SlimBrowser',\n      { 'label': 'SRWare Iron', 'pattern': 'Iron' },\n      'Sunrise',\n      'Swiftfox',\n      'Waterfox',\n      'WebPositive',\n      'Opera Mini',\n      { 'label': 'Opera Mini', 'pattern': 'OPiOS' },\n      'Opera',\n      { 'label': 'Opera', 'pattern': 'OPR' },\n      'Chrome',\n      { 'label': 'Chrome Mobile', 'pattern': '(?:CriOS|CrMo)' },\n      { 'label': 'Firefox', 'pattern': '(?:Firefox|Minefield)' },\n      { 'label': 'Firefox for iOS', 'pattern': 'FxiOS' },\n      { 'label': 'IE', 'pattern': 'IEMobile' },\n      { 'label': 'IE', 'pattern': 'MSIE' },\n      'Safari'\n    ]);\n\n    /* Detectable products (order is important). */\n    var product = getProduct([\n      { 'label': 'BlackBerry', 'pattern': 'BB10' },\n      'BlackBerry',\n      { 'label': 'Galaxy S', 'pattern': 'GT-I9000' },\n      { 'label': 'Galaxy S2', 'pattern': 'GT-I9100' },\n      { 'label': 'Galaxy S3', 'pattern': 'GT-I9300' },\n      { 'label': 'Galaxy S4', 'pattern': 'GT-I9500' },\n      { 'label': 'Galaxy S5', 'pattern': 'SM-G900' },\n      { 'label': 'Galaxy S6', 'pattern': 'SM-G920' },\n      { 'label': 'Galaxy S6 Edge', 'pattern': 'SM-G925' },\n      { 'label': 'Galaxy S7', 'pattern': 'SM-G930' },\n      { 'label': 'Galaxy S7 Edge', 'pattern': 'SM-G935' },\n      'Google TV',\n      'Lumia',\n      'iPad',\n      'iPod',\n      'iPhone',\n      'Kindle',\n      { 'label': 'Kindle Fire', 'pattern': '(?:Cloud9|Silk-Accelerated)' },\n      'Nexus',\n      'Nook',\n      'PlayBook',\n      'PlayStation Vita',\n      'PlayStation',\n      'TouchPad',\n      'Transformer',\n      { 'label': 'Wii U', 'pattern': 'WiiU' },\n      'Wii',\n      'Xbox One',\n      { 'label': 'Xbox 360', 'pattern': 'Xbox' },\n      'Xoom'\n    ]);\n\n    /* Detectable manufacturers. */\n    var manufacturer = getManufacturer({\n      'Apple': { 'iPad': 1, 'iPhone': 1, 'iPod': 1 },\n      'Archos': {},\n      'Amazon': { 'Kindle': 1, 'Kindle Fire': 1 },\n      'Asus': { 'Transformer': 1 },\n      'Barnes & Noble': { 'Nook': 1 },\n      'BlackBerry': { 'PlayBook': 1 },\n      'Google': { 'Google TV': 1, 'Nexus': 1 },\n      'HP': { 'TouchPad': 1 },\n      'HTC': {},\n      'LG': {},\n      'Microsoft': { 'Xbox': 1, 'Xbox One': 1 },\n      'Motorola': { 'Xoom': 1 },\n      'Nintendo': { 'Wii U': 1,  'Wii': 1 },\n      'Nokia': { 'Lumia': 1 },\n      'Samsung': { 'Galaxy S': 1, 'Galaxy S2': 1, 'Galaxy S3': 1, 'Galaxy S4': 1 },\n      'Sony': { 'PlayStation': 1, 'PlayStation Vita': 1 }\n    });\n\n    /* Detectable operating systems (order is important). */\n    var os = getOS([\n      'Windows Phone',\n      'Android',\n      'CentOS',\n      { 'label': 'Chrome OS', 'pattern': 'CrOS' },\n      'Debian',\n      'Fedora',\n      'FreeBSD',\n      'Gentoo',\n      'Haiku',\n      'Kubuntu',\n      'Linux Mint',\n      'OpenBSD',\n      'Red Hat',\n      'SuSE',\n      'Ubuntu',\n      'Xubuntu',\n      'Cygwin',\n      'Symbian OS',\n      'hpwOS',\n      'webOS ',\n      'webOS',\n      'Tablet OS',\n      'Tizen',\n      'Linux',\n      'Mac OS X',\n      'Macintosh',\n      'Mac',\n      'Windows 98;',\n      'Windows '\n    ]);\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * Picks the layout engine from an array of guesses.\n     *\n     * @private\n     * @param {Array} guesses An array of guesses.\n     * @returns {null|string} The detected layout engine.\n     */\n    function getLayout(guesses) {\n      return reduce(guesses, function(result, guess) {\n        return result || RegExp('\\\\b' + (\n          guess.pattern || qualify(guess)\n        ) + '\\\\b', 'i').exec(ua) && (guess.label || guess);\n      });\n    }\n\n    /**\n     * Picks the manufacturer from an array of guesses.\n     *\n     * @private\n     * @param {Array} guesses An object of guesses.\n     * @returns {null|string} The detected manufacturer.\n     */\n    function getManufacturer(guesses) {\n      return reduce(guesses, function(result, value, key) {\n        // Lookup the manufacturer by product or scan the UA for the manufacturer.\n        return result || (\n          value[product] ||\n          value[/^[a-z]+(?: +[a-z]+\\b)*/i.exec(product)] ||\n          RegExp('\\\\b' + qualify(key) + '(?:\\\\b|\\\\w*\\\\d)', 'i').exec(ua)\n        ) && key;\n      });\n    }\n\n    /**\n     * Picks the browser name from an array of guesses.\n     *\n     * @private\n     * @param {Array} guesses An array of guesses.\n     * @returns {null|string} The detected browser name.\n     */\n    function getName(guesses) {\n      return reduce(guesses, function(result, guess) {\n        return result || RegExp('\\\\b' + (\n          guess.pattern || qualify(guess)\n        ) + '\\\\b', 'i').exec(ua) && (guess.label || guess);\n      });\n    }\n\n    /**\n     * Picks the OS name from an array of guesses.\n     *\n     * @private\n     * @param {Array} guesses An array of guesses.\n     * @returns {null|string} The detected OS name.\n     */\n    function getOS(guesses) {\n      return reduce(guesses, function(result, guess) {\n        var pattern = guess.pattern || qualify(guess);\n        if (!result && (result =\n              RegExp('\\\\b' + pattern + '(?:/[\\\\d.]+|[ \\\\w.]*)', 'i').exec(ua)\n            )) {\n          result = cleanupOS(result, pattern, guess.label || guess);\n        }\n        return result;\n      });\n    }\n\n    /**\n     * Picks the product name from an array of guesses.\n     *\n     * @private\n     * @param {Array} guesses An array of guesses.\n     * @returns {null|string} The detected product name.\n     */\n    function getProduct(guesses) {\n      return reduce(guesses, function(result, guess) {\n        var pattern = guess.pattern || qualify(guess);\n        if (!result && (result =\n              RegExp('\\\\b' + pattern + ' *\\\\d+[.\\\\w_]*', 'i').exec(ua) ||\n              RegExp('\\\\b' + pattern + ' *\\\\w+-[\\\\w]*', 'i').exec(ua) ||\n              RegExp('\\\\b' + pattern + '(?:; *(?:[a-z]+[_-])?[a-z]+\\\\d+|[^ ();-]*)', 'i').exec(ua)\n            )) {\n          // Split by forward slash and append product version if needed.\n          if ((result = String((guess.label && !RegExp(pattern, 'i').test(guess.label)) ? guess.label : result).split('/'))[1] && !/[\\d.]+/.test(result[0])) {\n            result[0] += ' ' + result[1];\n          }\n          // Correct character case and cleanup string.\n          guess = guess.label || guess;\n          result = format(result[0]\n            .replace(RegExp(pattern, 'i'), guess)\n            .replace(RegExp('; *(?:' + guess + '[_-])?', 'i'), ' ')\n            .replace(RegExp('(' + guess + ')[-_.]?(\\\\w)', 'i'), '$1 $2'));\n        }\n        return result;\n      });\n    }\n\n    /**\n     * Resolves the version using an array of UA patterns.\n     *\n     * @private\n     * @param {Array} patterns An array of UA patterns.\n     * @returns {null|string} The detected version.\n     */\n    function getVersion(patterns) {\n      return reduce(patterns, function(result, pattern) {\n        return result || (RegExp(pattern +\n          '(?:-[\\\\d.]+/|(?: for [\\\\w-]+)?[ /-])([\\\\d.]+[^ ();/_-]*)', 'i').exec(ua) || 0)[1] || null;\n      });\n    }\n\n    /**\n     * Returns `platform.description` when the platform object is coerced to a string.\n     *\n     * @name toString\n     * @memberOf platform\n     * @returns {string} Returns `platform.description` if available, else an empty string.\n     */\n    function toStringPlatform() {\n      return this.description || '';\n    }\n\n    /*------------------------------------------------------------------------*/\n\n    // Convert layout to an array so we can add extra details.\n    layout && (layout = [layout]);\n\n    // Detect product names that contain their manufacturer's name.\n    if (manufacturer && !product) {\n      product = getProduct([manufacturer]);\n    }\n    // Clean up Google TV.\n    if ((data = /\\bGoogle TV\\b/.exec(product))) {\n      product = data[0];\n    }\n    // Detect simulators.\n    if (/\\bSimulator\\b/i.test(ua)) {\n      product = (product ? product + ' ' : '') + 'Simulator';\n    }\n    // Detect Opera Mini 8+ running in Turbo/Uncompressed mode on iOS.\n    if (name == 'Opera Mini' && /\\bOPiOS\\b/.test(ua)) {\n      description.push('running in Turbo/Uncompressed mode');\n    }\n    // Detect IE Mobile 11.\n    if (name == 'IE' && /\\blike iPhone OS\\b/.test(ua)) {\n      data = parse(ua.replace(/like iPhone OS/, ''));\n      manufacturer = data.manufacturer;\n      product = data.product;\n    }\n    // Detect iOS.\n    else if (/^iP/.test(product)) {\n      name || (name = 'Safari');\n      os = 'iOS' + ((data = / OS ([\\d_]+)/i.exec(ua))\n        ? ' ' + data[1].replace(/_/g, '.')\n        : '');\n    }\n    // Detect Kubuntu.\n    else if (name == 'Konqueror' && !/buntu/i.test(os)) {\n      os = 'Kubuntu';\n    }\n    // Detect Android browsers.\n    else if ((manufacturer && manufacturer != 'Google' &&\n        ((/Chrome/.test(name) && !/\\bMobile Safari\\b/i.test(ua)) || /\\bVita\\b/.test(product))) ||\n        (/\\bAndroid\\b/.test(os) && /^Chrome/.test(name) && /\\bVersion\\//i.test(ua))) {\n      name = 'Android Browser';\n      os = /\\bAndroid\\b/.test(os) ? os : 'Android';\n    }\n    // Detect Silk desktop/accelerated modes.\n    else if (name == 'Silk') {\n      if (!/\\bMobi/i.test(ua)) {\n        os = 'Android';\n        description.unshift('desktop mode');\n      }\n      if (/Accelerated *= *true/i.test(ua)) {\n        description.unshift('accelerated');\n      }\n    }\n    // Detect PaleMoon identifying as Firefox.\n    else if (name == 'PaleMoon' && (data = /\\bFirefox\\/([\\d.]+)\\b/.exec(ua))) {\n      description.push('identifying as Firefox ' + data[1]);\n    }\n    // Detect Firefox OS and products running Firefox.\n    else if (name == 'Firefox' && (data = /\\b(Mobile|Tablet|TV)\\b/i.exec(ua))) {\n      os || (os = 'Firefox OS');\n      product || (product = data[1]);\n    }\n    // Detect false positives for Firefox/Safari.\n    else if (!name || (data = !/\\bMinefield\\b/i.test(ua) && /\\b(?:Firefox|Safari)\\b/.exec(name))) {\n      // Escape the `/` for Firefox 1.\n      if (name && !product && /[\\/,]|^[^(]+?\\)/.test(ua.slice(ua.indexOf(data + '/') + 8))) {\n        // Clear name of false positives.\n        name = null;\n      }\n      // Reassign a generic name.\n      if ((data = product || manufacturer || os) &&\n          (product || manufacturer || /\\b(?:Android|Symbian OS|Tablet OS|webOS)\\b/.test(os))) {\n        name = /[a-z]+(?: Hat)?/i.exec(/\\bAndroid\\b/.test(os) ? os : data) + ' Browser';\n      }\n    }\n    // Add Chrome version to description for Electron.\n    else if (name == 'Electron' && (data = (/\\bChrome\\/([\\d.]+)\\b/.exec(ua) || 0)[1])) {\n      description.push('Chromium ' + data);\n    }\n    // Detect non-Opera (Presto-based) versions (order is important).\n    if (!version) {\n      version = getVersion([\n        '(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\\\d.]+$))',\n        'Version',\n        qualify(name),\n        '(?:Firefox|Minefield|NetFront)'\n      ]);\n    }\n    // Detect stubborn layout engines.\n    if ((data =\n          layout == 'iCab' && parseFloat(version) > 3 && 'WebKit' ||\n          /\\bOpera\\b/.test(name) && (/\\bOPR\\b/.test(ua) ? 'Blink' : 'Presto') ||\n          /\\b(?:Midori|Nook|Safari)\\b/i.test(ua) && !/^(?:Trident|EdgeHTML)$/.test(layout) && 'WebKit' ||\n          !layout && /\\bMSIE\\b/i.test(ua) && (os == 'Mac OS' ? 'Tasman' : 'Trident') ||\n          layout == 'WebKit' && /\\bPlayStation\\b(?! Vita\\b)/i.test(name) && 'NetFront'\n        )) {\n      layout = [data];\n    }\n    // Detect Windows Phone 7 desktop mode.\n    if (name == 'IE' && (data = (/; *(?:XBLWP|ZuneWP)(\\d+)/i.exec(ua) || 0)[1])) {\n      name += ' Mobile';\n      os = 'Windows Phone ' + (/\\+$/.test(data) ? data : data + '.x');\n      description.unshift('desktop mode');\n    }\n    // Detect Windows Phone 8.x desktop mode.\n    else if (/\\bWPDesktop\\b/i.test(ua)) {\n      name = 'IE Mobile';\n      os = 'Windows Phone 8.x';\n      description.unshift('desktop mode');\n      version || (version = (/\\brv:([\\d.]+)/.exec(ua) || 0)[1]);\n    }\n    // Detect IE 11 identifying as other browsers.\n    else if (name != 'IE' && layout == 'Trident' && (data = /\\brv:([\\d.]+)/.exec(ua))) {\n      if (name) {\n        description.push('identifying as ' + name + (version ? ' ' + version : ''));\n      }\n      name = 'IE';\n      version = data[1];\n    }\n    // Leverage environment features.\n    if (useFeatures) {\n      // Detect server-side environments.\n      // Rhino has a global function while others have a global object.\n      if (isHostType(context, 'global')) {\n        if (java) {\n          data = java.lang.System;\n          arch = data.getProperty('os.arch');\n          os = os || data.getProperty('os.name') + ' ' + data.getProperty('os.version');\n        }\n        if (rhino) {\n          try {\n            version = context.require('ringo/engine').version.join('.');\n            name = 'RingoJS';\n          } catch(e) {\n            if ((data = context.system) && data.global.system == context.system) {\n              name = 'Narwhal';\n              os || (os = data[0].os || null);\n            }\n          }\n          if (!name) {\n            name = 'Rhino';\n          }\n        }\n        else if (\n          typeof context.process == 'object' && !context.process.browser &&\n          (data = context.process)\n        ) {\n          if (typeof data.versions == 'object') {\n            if (typeof data.versions.electron == 'string') {\n              description.push('Node ' + data.versions.node);\n              name = 'Electron';\n              version = data.versions.electron;\n            } else if (typeof data.versions.nw == 'string') {\n              description.push('Chromium ' + version, 'Node ' + data.versions.node);\n              name = 'NW.js';\n              version = data.versions.nw;\n            }\n          }\n          if (!name) {\n            name = 'Node.js';\n            arch = data.arch;\n            os = data.platform;\n            version = /[\\d.]+/.exec(data.version);\n            version = version ? version[0] : null;\n          }\n        }\n      }\n      // Detect Adobe AIR.\n      else if (getClassOf((data = context.runtime)) == airRuntimeClass) {\n        name = 'Adobe AIR';\n        os = data.flash.system.Capabilities.os;\n      }\n      // Detect PhantomJS.\n      else if (getClassOf((data = context.phantom)) == phantomClass) {\n        name = 'PhantomJS';\n        version = (data = data.version || null) && (data.major + '.' + data.minor + '.' + data.patch);\n      }\n      // Detect IE compatibility modes.\n      else if (typeof doc.documentMode == 'number' && (data = /\\bTrident\\/(\\d+)/i.exec(ua))) {\n        // We're in compatibility mode when the Trident version + 4 doesn't\n        // equal the document mode.\n        version = [version, doc.documentMode];\n        if ((data = +data[1] + 4) != version[1]) {\n          description.push('IE ' + version[1] + ' mode');\n          layout && (layout[1] = '');\n          version[1] = data;\n        }\n        version = name == 'IE' ? String(version[1].toFixed(1)) : version[0];\n      }\n      // Detect IE 11 masking as other browsers.\n      else if (typeof doc.documentMode == 'number' && /^(?:Chrome|Firefox)\\b/.test(name)) {\n        description.push('masking as ' + name + ' ' + version);\n        name = 'IE';\n        version = '11.0';\n        layout = ['Trident'];\n        os = 'Windows';\n      }\n      os = os && format(os);\n    }\n    // Detect prerelease phases.\n    if (version && (data =\n          /(?:[ab]|dp|pre|[ab]\\d+pre)(?:\\d+\\+?)?$/i.exec(version) ||\n          /(?:alpha|beta)(?: ?\\d)?/i.exec(ua + ';' + (useFeatures && nav.appMinorVersion)) ||\n          /\\bMinefield\\b/i.test(ua) && 'a'\n        )) {\n      prerelease = /b/i.test(data) ? 'beta' : 'alpha';\n      version = version.replace(RegExp(data + '\\\\+?$'), '') +\n        (prerelease == 'beta' ? beta : alpha) + (/\\d+\\+?/.exec(data) || '');\n    }\n    // Detect Firefox Mobile.\n    if (name == 'Fennec' || name == 'Firefox' && /\\b(?:Android|Firefox OS)\\b/.test(os)) {\n      name = 'Firefox Mobile';\n    }\n    // Obscure Maxthon's unreliable version.\n    else if (name == 'Maxthon' && version) {\n      version = version.replace(/\\.[\\d.]+/, '.x');\n    }\n    // Detect Xbox 360 and Xbox One.\n    else if (/\\bXbox\\b/i.test(product)) {\n      if (product == 'Xbox 360') {\n        os = null;\n      }\n      if (product == 'Xbox 360' && /\\bIEMobile\\b/.test(ua)) {\n        description.unshift('mobile mode');\n      }\n    }\n    // Add mobile postfix.\n    else if ((/^(?:Chrome|IE|Opera)$/.test(name) || name && !product && !/Browser|Mobi/.test(name)) &&\n        (os == 'Windows CE' || /Mobi/i.test(ua))) {\n      name += ' Mobile';\n    }\n    // Detect IE platform preview.\n    else if (name == 'IE' && useFeatures) {\n      try {\n        if (context.external === null) {\n          description.unshift('platform preview');\n        }\n      } catch(e) {\n        description.unshift('embedded');\n      }\n    }\n    // Detect BlackBerry OS version.\n    // http://docs.blackberry.com/en/developers/deliverables/18169/HTTP_headers_sent_by_BB_Browser_1234911_11.jsp\n    else if ((/\\bBlackBerry\\b/.test(product) || /\\bBB10\\b/.test(ua)) && (data =\n          (RegExp(product.replace(/ +/g, ' *') + '/([.\\\\d]+)', 'i').exec(ua) || 0)[1] ||\n          version\n        )) {\n      data = [data, /BB10/.test(ua)];\n      os = (data[1] ? (product = null, manufacturer = 'BlackBerry') : 'Device Software') + ' ' + data[0];\n      version = null;\n    }\n    // Detect Opera identifying/masking itself as another browser.\n    // http://www.opera.com/support/kb/view/843/\n    else if (this != forOwn && product != 'Wii' && (\n          (useFeatures && opera) ||\n          (/Opera/.test(name) && /\\b(?:MSIE|Firefox)\\b/i.test(ua)) ||\n          (name == 'Firefox' && /\\bOS X (?:\\d+\\.){2,}/.test(os)) ||\n          (name == 'IE' && (\n            (os && !/^Win/.test(os) && version > 5.5) ||\n            /\\bWindows XP\\b/.test(os) && version > 8 ||\n            version == 8 && !/\\bTrident\\b/.test(ua)\n          ))\n        ) && !reOpera.test((data = parse.call(forOwn, ua.replace(reOpera, '') + ';'))) && data.name) {\n      // When \"identifying\", the UA contains both Opera and the other browser's name.\n      data = 'ing as ' + data.name + ((data = data.version) ? ' ' + data : '');\n      if (reOpera.test(name)) {\n        if (/\\bIE\\b/.test(data) && os == 'Mac OS') {\n          os = null;\n        }\n        data = 'identify' + data;\n      }\n      // When \"masking\", the UA contains only the other browser's name.\n      else {\n        data = 'mask' + data;\n        if (operaClass) {\n          name = format(operaClass.replace(/([a-z])([A-Z])/g, '$1 $2'));\n        } else {\n          name = 'Opera';\n        }\n        if (/\\bIE\\b/.test(data)) {\n          os = null;\n        }\n        if (!useFeatures) {\n          version = null;\n        }\n      }\n      layout = ['Presto'];\n      description.push(data);\n    }\n    // Detect WebKit Nightly and approximate Chrome/Safari versions.\n    if ((data = (/\\bAppleWebKit\\/([\\d.]+\\+?)/i.exec(ua) || 0)[1])) {\n      // Correct build number for numeric comparison.\n      // (e.g. \"532.5\" becomes \"532.05\")\n      data = [parseFloat(data.replace(/\\.(\\d)$/, '.0$1')), data];\n      // Nightly builds are postfixed with a \"+\".\n      if (name == 'Safari' && data[1].slice(-1) == '+') {\n        name = 'WebKit Nightly';\n        prerelease = 'alpha';\n        version = data[1].slice(0, -1);\n      }\n      // Clear incorrect browser versions.\n      else if (version == data[1] ||\n          version == (data[2] = (/\\bSafari\\/([\\d.]+\\+?)/i.exec(ua) || 0)[1])) {\n        version = null;\n      }\n      // Use the full Chrome version when available.\n      data[1] = (/\\bChrome\\/([\\d.]+)/i.exec(ua) || 0)[1];\n      // Detect Blink layout engine.\n      if (data[0] == 537.36 && data[2] == 537.36 && parseFloat(data[1]) >= 28 && layout == 'WebKit') {\n        layout = ['Blink'];\n      }\n      // Detect JavaScriptCore.\n      // http://stackoverflow.com/questions/6768474/how-can-i-detect-which-javascript-engine-v8-or-jsc-is-used-at-runtime-in-androi\n      if (!useFeatures || (!likeChrome && !data[1])) {\n        layout && (layout[1] = 'like Safari');\n        data = (data = data[0], data < 400 ? 1 : data < 500 ? 2 : data < 526 ? 3 : data < 533 ? 4 : data < 534 ? '4+' : data < 535 ? 5 : data < 537 ? 6 : data < 538 ? 7 : data < 601 ? 8 : '8');\n      } else {\n        layout && (layout[1] = 'like Chrome');\n        data = data[1] || (data = data[0], data < 530 ? 1 : data < 532 ? 2 : data < 532.05 ? 3 : data < 533 ? 4 : data < 534.03 ? 5 : data < 534.07 ? 6 : data < 534.10 ? 7 : data < 534.13 ? 8 : data < 534.16 ? 9 : data < 534.24 ? 10 : data < 534.30 ? 11 : data < 535.01 ? 12 : data < 535.02 ? '13+' : data < 535.07 ? 15 : data < 535.11 ? 16 : data < 535.19 ? 17 : data < 536.05 ? 18 : data < 536.10 ? 19 : data < 537.01 ? 20 : data < 537.11 ? '21+' : data < 537.13 ? 23 : data < 537.18 ? 24 : data < 537.24 ? 25 : data < 537.36 ? 26 : layout != 'Blink' ? '27' : '28');\n      }\n      // Add the postfix of \".x\" or \"+\" for approximate versions.\n      layout && (layout[1] += ' ' + (data += typeof data == 'number' ? '.x' : /[.+]/.test(data) ? '' : '+'));\n      // Obscure version for some Safari 1-2 releases.\n      if (name == 'Safari' && (!version || parseInt(version) > 45)) {\n        version = data;\n      }\n    }\n    // Detect Opera desktop modes.\n    if (name == 'Opera' &&  (data = /\\bzbov|zvav$/.exec(os))) {\n      name += ' ';\n      description.unshift('desktop mode');\n      if (data == 'zvav') {\n        name += 'Mini';\n        version = null;\n      } else {\n        name += 'Mobile';\n      }\n      os = os.replace(RegExp(' *' + data + '$'), '');\n    }\n    // Detect Chrome desktop mode.\n    else if (name == 'Safari' && /\\bChrome\\b/.exec(layout && layout[1])) {\n      description.unshift('desktop mode');\n      name = 'Chrome Mobile';\n      version = null;\n\n      if (/\\bOS X\\b/.test(os)) {\n        manufacturer = 'Apple';\n        os = 'iOS 4.3+';\n      } else {\n        os = null;\n      }\n    }\n    // Strip incorrect OS versions.\n    if (version && version.indexOf((data = /[\\d.]+$/.exec(os))) == 0 &&\n        ua.indexOf('/' + data + '-') > -1) {\n      os = trim(os.replace(data, ''));\n    }\n    // Add layout engine.\n    if (layout && !/\\b(?:Avant|Nook)\\b/.test(name) && (\n        /Browser|Lunascape|Maxthon/.test(name) ||\n        name != 'Safari' && /^iOS/.test(os) && /\\bSafari\\b/.test(layout[1]) ||\n        /^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(name) && layout[1])) {\n      // Don't add layout details to description if they are falsey.\n      (data = layout[layout.length - 1]) && description.push(data);\n    }\n    // Combine contextual information.\n    if (description.length) {\n      description = ['(' + description.join('; ') + ')'];\n    }\n    // Append manufacturer to description.\n    if (manufacturer && product && product.indexOf(manufacturer) < 0) {\n      description.push('on ' + manufacturer);\n    }\n    // Append product to description.\n    if (product) {\n      description.push((/^on /.test(description[description.length - 1]) ? '' : 'on ') + product);\n    }\n    // Parse the OS into an object.\n    if (os) {\n      data = / ([\\d.+]+)$/.exec(os);\n      isSpecialCasedOS = data && os.charAt(os.length - data[0].length - 1) == '/';\n      os = {\n        'architecture': 32,\n        'family': (data && !isSpecialCasedOS) ? os.replace(data[0], '') : os,\n        'version': data ? data[1] : null,\n        'toString': function() {\n          var version = this.version;\n          return this.family + ((version && !isSpecialCasedOS) ? ' ' + version : '') + (this.architecture == 64 ? ' 64-bit' : '');\n        }\n      };\n    }\n    // Add browser/OS architecture.\n    if ((data = /\\b(?:AMD|IA|Win|WOW|x86_|x)64\\b/i.exec(arch)) && !/\\bi686\\b/i.test(arch)) {\n      if (os) {\n        os.architecture = 64;\n        os.family = os.family.replace(RegExp(' *' + data), '');\n      }\n      if (\n          name && (/\\bWOW64\\b/i.test(ua) ||\n          (useFeatures && /\\w(?:86|32)$/.test(nav.cpuClass || nav.platform) && !/\\bWin64; x64\\b/i.test(ua)))\n      ) {\n        description.unshift('32-bit');\n      }\n    }\n    // Chrome 39 and above on OS X is always 64-bit.\n    else if (\n        os && /^OS X/.test(os.family) &&\n        name == 'Chrome' && parseFloat(version) >= 39\n    ) {\n      os.architecture = 64;\n    }\n\n    ua || (ua = null);\n\n    /*------------------------------------------------------------------------*/\n\n    /**\n     * The platform object.\n     *\n     * @name platform\n     * @type Object\n     */\n    var platform = {};\n\n    /**\n     * The platform description.\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.description = ua;\n\n    /**\n     * The name of the browser's layout engine.\n     *\n     * The list of common layout engines include:\n     * \"Blink\", \"EdgeHTML\", \"Gecko\", \"Trident\" and \"WebKit\"\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.layout = layout && layout[0];\n\n    /**\n     * The name of the product's manufacturer.\n     *\n     * The list of manufacturers include:\n     * \"Apple\", \"Archos\", \"Amazon\", \"Asus\", \"Barnes & Noble\", \"BlackBerry\",\n     * \"Google\", \"HP\", \"HTC\", \"LG\", \"Microsoft\", \"Motorola\", \"Nintendo\",\n     * \"Nokia\", \"Samsung\" and \"Sony\"\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.manufacturer = manufacturer;\n\n    /**\n     * The name of the browser/environment.\n     *\n     * The list of common browser names include:\n     * \"Chrome\", \"Electron\", \"Firefox\", \"Firefox for iOS\", \"IE\",\n     * \"Microsoft Edge\", \"PhantomJS\", \"Safari\", \"SeaMonkey\", \"Silk\",\n     * \"Opera Mini\" and \"Opera\"\n     *\n     * Mobile versions of some browsers have \"Mobile\" appended to their name:\n     * eg. \"Chrome Mobile\", \"Firefox Mobile\", \"IE Mobile\" and \"Opera Mobile\"\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.name = name;\n\n    /**\n     * The alpha/beta release indicator.\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.prerelease = prerelease;\n\n    /**\n     * The name of the product hosting the browser.\n     *\n     * The list of common products include:\n     *\n     * \"BlackBerry\", \"Galaxy S4\", \"Lumia\", \"iPad\", \"iPod\", \"iPhone\", \"Kindle\",\n     * \"Kindle Fire\", \"Nexus\", \"Nook\", \"PlayBook\", \"TouchPad\" and \"Transformer\"\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.product = product;\n\n    /**\n     * The browser's user agent string.\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.ua = ua;\n\n    /**\n     * The browser/environment version.\n     *\n     * @memberOf platform\n     * @type string|null\n     */\n    platform.version = name && version;\n\n    /**\n     * The name of the operating system.\n     *\n     * @memberOf platform\n     * @type Object\n     */\n    platform.os = os || {\n\n      /**\n       * The CPU architecture the OS is built for.\n       *\n       * @memberOf platform.os\n       * @type number|null\n       */\n      'architecture': null,\n\n      /**\n       * The family of the OS.\n       *\n       * Common values include:\n       * \"Windows\", \"Windows Server 2008 R2 / 7\", \"Windows Server 2008 / Vista\",\n       * \"Windows XP\", \"OS X\", \"Ubuntu\", \"Debian\", \"Fedora\", \"Red Hat\", \"SuSE\",\n       * \"Android\", \"iOS\" and \"Windows Phone\"\n       *\n       * @memberOf platform.os\n       * @type string|null\n       */\n      'family': null,\n\n      /**\n       * The version of the OS.\n       *\n       * @memberOf platform.os\n       * @type string|null\n       */\n      'version': null,\n\n      /**\n       * Returns the OS string.\n       *\n       * @memberOf platform.os\n       * @returns {string} The OS string.\n       */\n      'toString': function() { return 'null'; }\n    };\n\n    platform.parse = parse;\n    platform.toString = toStringPlatform;\n\n    if (platform.version) {\n      description.unshift(version);\n    }\n    if (platform.name) {\n      description.unshift(name);\n    }\n    if (os && name && !(os == String(os).split(' ')[0] && (os == name.split(' ')[0] || product))) {\n      description.push(product ? '(' + os + ')' : 'on ' + os);\n    }\n    if (description.length) {\n      platform.description = description.join(' ');\n    }\n    return platform;\n  }\n\n  /*--------------------------------------------------------------------------*/\n\n  // Export platform.\n  var platform = parse();\n\n  // Some AMD build optimizers, like r.js, check for condition patterns like the following:\n  if (typeof define == 'function' && typeof define.amd == 'object' && define.amd) {\n    // Expose platform on the global object to prevent errors when platform is\n    // loaded by a script tag in the presence of an AMD loader.\n    // See http://requirejs.org/docs/errors.html#mismatch for more details.\n    root.platform = platform;\n\n    // Define as an anonymous module so platform can be aliased through path mapping.\n    define(function() {\n      return platform;\n    });\n  }\n  // Check for `exports` after `define` in case a build optimizer adds an `exports` object.\n  else if (freeExports && freeModule) {\n    // Export for CommonJS support.\n    forOwn(platform, function(value, key) {\n      freeExports[key] = value;\n    });\n  }\n  else {\n    // Export to the global object.\n    root.platform = platform;\n  }\n}.call(this));\n","const getTimezoneOffsetString = date => {\n  const rawOffset = date.getTimezoneOffset() / 60; // JSTであれば date.getTimezoneOffset() は -540\n  const sign = rawOffset > 0 ? '-' : '+';\n\n  let offsetStr = Math.abs(rawOffset);\n  if (offsetStr < 10) {\n    offsetStr = `0${offsetStr}`;\n  }\n\n  return `${sign}${offsetStr}00`;\n};\n\nexport const formatDate = (date, timezone = false) => {\n  const year = date.getFullYear();\n  let month = date.getMonth() + 1;\n  let dates = date.getDate();\n  let hours = date.getHours();\n  let minutes = date.getMinutes();\n  let seconds = date.getSeconds();\n  const millisec = `${date.getMilliseconds()}0`;\n\n  if (month < 10) { month = `0${month}`; }\n  if (dates < 10) { dates = `0${dates}`; }\n  if (hours < 10) { hours = `0${hours}`; }\n  if (minutes < 10) { minutes = `0${minutes}`; }\n  if (seconds < 10) { seconds = `0${seconds}`; }\n\n  if (timezone) {\n    return `${year}${month}${dates}${hours}${minutes}${seconds}${millisec} ${getTimezoneOffsetString(date)}`;\n  }\n  return `${year}${month}${dates}${hours}${minutes}${seconds}${millisec}`;\n};\n\nexport const ls = {\n  get(key) {\n    return localStorage.getItem(key);\n  },\n  getAllItems() {\n    return Object.assign({}, localStorage);\n  },\n  set(key, val) {\n    try {\n      localStorage.setItem(key, val);\n    } catch (e) {\n      if (e.name === 'QuotaExceededError') {\n        // localStorageの容量を使い尽くすと上がる例外。private modeのSafariだと、localStorageにアクセスするだけで発生する。\n        console.warn('If you\\'re browsing with private mode, please turn it off for better usability.');\n      } else {\n        throw e;\n      }\n    }\n  },\n};\n\n// TODO: specを追加\n// TODO: hex8の値自体はconfigから取得するのでinvalidなケースは少ないはずだが、hex8としてvalidateしconsole.errorとする\nexport const hex8ToRgba = (hex8) => {\n  if (hex8.length !== 8) return hex8;\n  const hex8Array = hex8.match(/.{2}/g);\n  const rgb = hex8Array.slice(0, 3).map((x) => Number(`0x${x}`)).join();\n  const alpha = Number(`0x${hex8Array.slice(3)}`) / 255;\n  const rgbaText = `rgba(${rgb},${alpha})`;\n  if (rgbaText.includes(NaN)) return hex8;\n  return rgbaText;\n};\n","// https://github.com/kelektiv/node-uuid\n// extracted from https://wzrd.in/standalone/uuid%2Fv1@latest\n/* eslint-disable */\n!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define([],e);else{var r;r=\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:\"undefined\"!=typeof self?self:this,r.uuidv1=e()}}(function(){return function e(r,n,o){function t(u,f){if(!n[u]){if(!r[u]){var s=\"function\"==typeof require&&require;if(!f&&s)return s(u,!0);if(i)return i(u,!0);var d=new Error(\"Cannot find module '\"+u+\"'\");throw d.code=\"MODULE_NOT_FOUND\",d}var a=n[u]={exports:{}};r[u][0].call(a.exports,function(e){var n=r[u][1][e];return t(n?n:e)},a,a.exports,e,r,n,o)}return n[u].exports}for(var i=\"function\"==typeof require&&require,u=0;u<o.length;u++)t(o[u]);return t}({1:[function(e,r,n){function o(e,r){var n=r||0,o=t;return o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+\"-\"+o[e[n++]]+o[e[n++]]+\"-\"+o[e[n++]]+o[e[n++]]+\"-\"+o[e[n++]]+o[e[n++]]+\"-\"+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]+o[e[n++]]}for(var t=[],i=0;i<256;++i)t[i]=(i+256).toString(16).substr(1);r.exports=o},{}],2:[function(e,r,n){var o=\"undefined\"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||\"undefined\"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(o){var t=new Uint8Array(16);r.exports=function(){return o(t),t}}else{var i=new Array(16);r.exports=function(){for(var e,r=0;r<16;r++)0===(3&r)&&(e=4294967296*Math.random()),i[r]=e>>>((3&r)<<3)&255;return i}}},{}],3:[function(e,r,n){function o(e,r,n){var o=r&&n||0,a=r||[];e=e||{};var c=e.node||t,l=void 0!==e.clockseq?e.clockseq:i;if(null==c||null==l){var v=u();null==c&&(c=t=[1|v[0],v[1],v[2],v[3],v[4],v[5]]),null==l&&(l=i=16383&(v[6]<<8|v[7]))}var p=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:d+1,m=p-s+(y-d)/1e4;if(m<0&&void 0===e.clockseq&&(l=l+1&16383),(m<0||p>s)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");s=p,d=y,i=l,p+=122192928e5;var b=(1e4*(268435455&p)+y)%4294967296;a[o++]=b>>>24&255,a[o++]=b>>>16&255,a[o++]=b>>>8&255,a[o++]=255&b;var w=p/4294967296*1e4&268435455;a[o++]=w>>>8&255,a[o++]=255&w,a[o++]=w>>>24&15|16,a[o++]=w>>>16&255,a[o++]=l>>>8|128,a[o++]=255&l;for(var x=0;x<6;++x)a[o+x]=c[x];return r?r:f(a)}var t,i,u=e(\"./lib/rng\"),f=e(\"./lib/bytesToUuid\"),s=0,d=0;r.exports=o},{\"./lib/bytesToUuid\":1,\"./lib/rng\":2}]},{},[3])(3)});\n","// FIXME: cookie keyにtokenを入れた方が良い？\nexport const USER_ID_COOKIE_KEY = 'rpr_uid';\n\n// Session\nexport const CURRENT_SESSION_STARTED_AT_COOKIE_KEY = 'rpr_session_started_at';\nexport const LAST_EVENT_TRACKED_AT_COOKIE_KEY = 'rpr_event_last_tracked_at';\nexport const SESSION_EXPIRY_INTERVAL = 30 * 60000; // 30 minutes\n\n// Event\nexport const EVENT_NAME_LENGTH_MAX = 191; // Max size of unique index of MySQL. 767 bytes / 4 bytes as UTF32.\nexport const EVENT_PROPERTIES_MAX = 20; // For more details, see https://repro.esa.io/posts/8722\nexport const EVENT_PROPERTY_NAME_MAX = 48; // For more details, see https://repro.esa.io/posts/8722#comment-332818\nexport const STANDARD_EVENT_PREFIX = '___repro___';\n\n// User Pofile\nexport const USER_PROFILE_KEY_LENGTH_MAX = 255; // Max size of varchar(255) COLLATE utf8mb4_bin\nexport const USER_PROFILE_VALUE_LENGTH_MAX = 255;\nexport const STANDARD_USER_PROFILE_PREFIX = '___repro___';\n\n// Message\nexport const SHOWN_MESSAGES_STORAGE_KEY = token => `rpr_shown_messages:${token}`;\n","import cookie from 'js-cookie';\n\nimport {\n  CURRENT_SESSION_STARTED_AT_COOKIE_KEY,\n  LAST_EVENT_TRACKED_AT_COOKIE_KEY,\n  SESSION_EXPIRY_INTERVAL,\n} from './constants';\n\nexport default class SessionManager {\n  constructor() {\n    const now = new Date();\n\n    if (!!this.lastEventTrackedAt && !!this.currentSessionstartedAt && this.currentSessionExpireAt > now) {\n      // noop since session is continuous from previous event occurrence\n    } else {\n      // new session\n      this.updatecurrentSessionStartedAt(now);\n    }\n  }\n  get currentSessionstartedAt() {\n    return this.epochToDate(cookie.get(CURRENT_SESSION_STARTED_AT_COOKIE_KEY));\n  }\n  get lastEventTrackedAt() {\n    return this.epochToDate(cookie.get(LAST_EVENT_TRACKED_AT_COOKIE_KEY));\n  }\n  get currentSessionExpireAt() {\n    if (!this.lastEventTrackedAt) return null;\n    return new Date(this.lastEventTrackedAt.getTime() + SESSION_EXPIRY_INTERVAL);\n  }\n  epochToDate(epoch) {\n    const date = new Date(parseInt(epoch, 10));\n    return isNaN(date.getTime()) ? null : date;\n  }\n  isNewSession(date) {\n    // completely new session will not have anything stored and currentSessionExpireAt will be 'Invalid Date'\n    if (this.currentSessionExpireAt === null) return true;\n    if (isNaN(this.currentSessionExpireAt.getTime())) return true;\n\n    return this.currentSessionExpireAt < date;\n  }\n  updatecurrentSessionStartedAt(date) {\n    cookie.set(CURRENT_SESSION_STARTED_AT_COOKIE_KEY, date.getTime());\n  }\n  updateLastEventTrackedAt(date) {\n    cookie.set(LAST_EVENT_TRACKED_AT_COOKIE_KEY, date.getTime());\n  }\n}\n","'use strict';\n\n// Store setTimeout reference so promise-polyfill will be unaffected by\n// other code modifying setTimeout (like sinon.useFakeTimers())\nvar setTimeoutFunc = setTimeout;\n\nfunction noop() {}\n\n// Polyfill for Function.prototype.bind\nfunction bind(fn, thisArg) {\n  return function() {\n    fn.apply(thisArg, arguments);\n  };\n}\n\nfunction Promise(fn) {\n  if (!(this instanceof Promise))\n    throw new TypeError('Promises must be constructed via new');\n  if (typeof fn !== 'function') throw new TypeError('not a function');\n  this._state = 0;\n  this._handled = false;\n  this._value = undefined;\n  this._deferreds = [];\n\n  doResolve(fn, this);\n}\n\nfunction handle(self, deferred) {\n  while (self._state === 3) {\n    self = self._value;\n  }\n  if (self._state === 0) {\n    self._deferreds.push(deferred);\n    return;\n  }\n  self._handled = true;\n  Promise._immediateFn(function() {\n    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n    if (cb === null) {\n      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n      return;\n    }\n    var ret;\n    try {\n      ret = cb(self._value);\n    } catch (e) {\n      reject(deferred.promise, e);\n      return;\n    }\n    resolve(deferred.promise, ret);\n  });\n}\n\nfunction resolve(self, newValue) {\n  try {\n    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n    if (newValue === self)\n      throw new TypeError('A promise cannot be resolved with itself.');\n    if (\n      newValue &&\n      (typeof newValue === 'object' || typeof newValue === 'function')\n    ) {\n      var then = newValue.then;\n      if (newValue instanceof Promise) {\n        self._state = 3;\n        self._value = newValue;\n        finale(self);\n        return;\n      } else if (typeof then === 'function') {\n        doResolve(bind(then, newValue), self);\n        return;\n      }\n    }\n    self._state = 1;\n    self._value = newValue;\n    finale(self);\n  } catch (e) {\n    reject(self, e);\n  }\n}\n\nfunction reject(self, newValue) {\n  self._state = 2;\n  self._value = newValue;\n  finale(self);\n}\n\nfunction finale(self) {\n  if (self._state === 2 && self._deferreds.length === 0) {\n    Promise._immediateFn(function() {\n      if (!self._handled) {\n        Promise._unhandledRejectionFn(self._value);\n      }\n    });\n  }\n\n  for (var i = 0, len = self._deferreds.length; i < len; i++) {\n    handle(self, self._deferreds[i]);\n  }\n  self._deferreds = null;\n}\n\nfunction Handler(onFulfilled, onRejected, promise) {\n  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n  this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n  this.promise = promise;\n}\n\n/**\n * Take a potentially misbehaving resolver function and make sure\n * onFulfilled and onRejected are only called once.\n *\n * Makes no guarantees about asynchrony.\n */\nfunction doResolve(fn, self) {\n  var done = false;\n  try {\n    fn(\n      function(value) {\n        if (done) return;\n        done = true;\n        resolve(self, value);\n      },\n      function(reason) {\n        if (done) return;\n        done = true;\n        reject(self, reason);\n      }\n    );\n  } catch (ex) {\n    if (done) return;\n    done = true;\n    reject(self, ex);\n  }\n}\n\nPromise.prototype['catch'] = function(onRejected) {\n  return this.then(null, onRejected);\n};\n\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  var prom = new this.constructor(noop);\n\n  handle(this, new Handler(onFulfilled, onRejected, prom));\n  return prom;\n};\n\nPromise.prototype['finally'] = function(callback) {\n  var constructor = this.constructor;\n  return this.then(\n    function(value) {\n      return constructor.resolve(callback()).then(function() {\n        return value;\n      });\n    },\n    function(reason) {\n      return constructor.resolve(callback()).then(function() {\n        return constructor.reject(reason);\n      });\n    }\n  );\n};\n\nPromise.all = function(arr) {\n  return new Promise(function(resolve, reject) {\n    if (!arr || typeof arr.length === 'undefined')\n      throw new TypeError('Promise.all accepts an array');\n    var args = Array.prototype.slice.call(arr);\n    if (args.length === 0) return resolve([]);\n    var remaining = args.length;\n\n    function res(i, val) {\n      try {\n        if (val && (typeof val === 'object' || typeof val === 'function')) {\n          var then = val.then;\n          if (typeof then === 'function') {\n            then.call(\n              val,\n              function(val) {\n                res(i, val);\n              },\n              reject\n            );\n            return;\n          }\n        }\n        args[i] = val;\n        if (--remaining === 0) {\n          resolve(args);\n        }\n      } catch (ex) {\n        reject(ex);\n      }\n    }\n\n    for (var i = 0; i < args.length; i++) {\n      res(i, args[i]);\n    }\n  });\n};\n\nPromise.resolve = function(value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function(resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function(value) {\n  return new Promise(function(resolve, reject) {\n    reject(value);\n  });\n};\n\nPromise.race = function(values) {\n  return new Promise(function(resolve, reject) {\n    for (var i = 0, len = values.length; i < len; i++) {\n      values[i].then(resolve, reject);\n    }\n  });\n};\n\n// Use polyfill for setImmediate for performance gains\nPromise._immediateFn =\n  (typeof setImmediate === 'function' &&\n    function(fn) {\n      setImmediate(fn);\n    }) ||\n  function(fn) {\n    setTimeoutFunc(fn, 0);\n  };\n\nPromise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n  if (typeof console !== 'undefined' && console) {\n    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console\n  }\n};\n\nmodule.exports = Promise;\n","import Promise from 'promise-polyfill';\nimport { version } from '../package.json' // eslint-disable-line\n\n// TODO: HTTPとHTTPSでconfigurableにする\n// TODO: env によって切り替える\n// const CONFIGURATION_URL = 'https://api.repro.io/v1/internal/web/config';\nconst CONFIGURATION_URL = 'https://edwardkenfox-api.repro.io/v1/internal/web/config';\nconst HTTP_STATUS_UNAUTHORIZED = 401;\n\nexport default class Configuration {\n  constructor() {\n    this.response = {};\n    this.appId = null;\n    this.trackable = true;\n    this.configured = false;\n    this.ipAddress = '';\n    this.messages = [];\n  }\n\n  call(params) {\n    if (['idfv', 'token', 'isFirstLaunch'].some(prop => params[prop] === undefined)) {\n      return Promise.reject('Aborting configuration API call due to idfv or token or isFirstLaunch missing.');\n    }\n\n    if ('onLine' in navigator && !navigator.onLine) {\n      // この場合は trackable: false にするのではなく、trackしたイベントを cache storage かどこかに置いておいて、\n      // 次の config成功時 or オンラインに復帰したときにcustom_eventsにマージできればオフライン対応完了か？（希望的観測）\n      // オフライン対応時には trackable だけじゃなくオフライン時の状態も保持する必要あるが、詳細は追って考える\n      // https://repro.esa.io/posts/13891#comment-511496\n      return Promise.reject('Aborting configuration API call due to browser being offline.');\n    }\n\n    const data = JSON.stringify({\n      user_annotation: params.user_annotation || '',\n      idfv: params.idfv,\n      token: params.token,\n      is_first_launch: params.isFirstLaunch,\n      sdk_version: version,\n      os: 'web',\n    });\n\n    return new Promise((resolve, reject) => {\n      if ('fetch' in window) {\n        return fetch(CONFIGURATION_URL, {\n          method: 'POST',\n          headers: { 'Content-Type': 'application/json' },\n          body: data,\n          mode: 'cors',\n        })\n          .then(res => {\n            this.response = res;\n            if (!this.response.ok) {\n              throw new Error(this.response.statusText);\n            }\n            return this.response.json();\n          })\n          .then(json => {\n            this.appId = json.insight.app_id;\n            this.trackable = json.insight.trackable;\n            this.configured = true;\n            this.ipAddress = json.insight.ip_address;\n            // this.messages = json.insight.messages || [];\n            this.messages = json.web_messages || [];\n            return resolve(this);\n          })\n          .catch(err => { // eslint-disable-line\n            if (this.response.status === HTTP_STATUS_UNAUTHORIZED) {\n              this.trackable = false;\n              return reject('Configuration API call failed due to authentication error. Check your repro token.');\n            }\n            return reject(`Configuration API call failed with status ${this.response.status}.`);\n          });\n      }\n      try {\n        // IE対応を一切しなくてよくなれば fetch が全面的に利用できるのでこっちは消せる\n        const xhr = new XMLHttpRequest();\n        xhr.onload = () => {\n          if (xhr.status === 200) {\n            const body = 'response' in xhr ? xhr.response : xhr.responseText;\n            const json = JSON.parse(body);\n\n            this.appId = json.insight.app_id;\n            this.trackable = json.insight.trackable;\n            this.configured = true;\n            this.ipAddress = json.insight.ip_address;\n            this.messages = json.messages || [];\n          } else if (xhr.status === HTTP_STATUS_UNAUTHORIZED) {\n            console.warn('Configuration API call failed due to authentication error. Check your repro token.');\n          } else {\n            console.warn(`Configuration API call failed with status ${xhr.status}`);\n          }\n          return resolve(this);\n        };\n        xhr.onerror = () => {\n          console.warn('Configuration API call failed for an unknown reason.');\n          return resolve(this);\n        };\n        xhr.ontimeout = () => {\n          console.warn('Configuration API call timed out.');\n          return resolve(this);\n        };\n        xhr.open('POST', CONFIGURATION_URL, true);\n        xhr.setRequestHeader('Content-Type', 'application/json');\n        xhr.withCredentials = false;\n        xhr.send(data);\n        return resolve(this);\n      } catch (err) {\n        return reject(this);\n      }\n    });\n  }\n\n  get shouldClearCustomEvents() {\n    return this.response.status === 200 && !this.trackable;\n  }\n}\n","import {\n  ls,\n  formatDate,\n  hex8ToRgba,\n} from './util';\nimport { SHOWN_MESSAGES_STORAGE_KEY } from './constants';\n\n// https://jsfiddle.net/alexkwa/yebyy1sL/\n// TODO: split style elements to each types\n// TODO: minify css\n// TODO: use css variable for pixels and stuff\nconst messageStyles = `#repro-message--dialog--overlay-wrapper{background:rgba(0,0,0,0.8);position:fixed;width:100%;height:100%;left:0;top:0;z-index:1000;display:flex;align-items:center;justify-content:center;}#repro-message--dialog--closer{height:100%;left:0;position:fixed;top:0;width:100%;z-index:100;}#repro-message--dialog--container{background:white;display:inline-flex;margin-top:24px;max-width:700px;z-index:101;min-height:200px;padding:0;position:relative;border:0;box-shadow:03px12pxrgba(27,31,35,0.15);overflow:hidden;}#repro-message--dialog--content{display:flex;align-items:center;}#repro-message--dialog--image-container{display:flex;min-width:266px;overflow:hidden;background-size:cover;background-position:center;}#repro-message--dialog--text{padding:24px;overflow:hidden;}#repro-message--dialog--header{color:black;font-family:inherit;font-size:1em;line-height:1.2;font-weight:bold;overflow:hidden;}#repro-message--dialog--body{color:rgba(0,0,0,0.8);line-height:1.2;margin-top:8px;font-family:inherit;font-size:0.9em;overflow:hidden;}#repro-message--dialog--button-container{display:inline-flex;align-items:flex-start;flex-wrap:wrap;}#repro-message--dialog--primary-button-text,#repro-message--dialog--secondary-button-text{border:1pxsolid#000;box-sizing:border-box;border-radius:6px;margin-top:12px;max-width:385px;overflow:hidden;padding:8px14px;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;text-align:center;user-select:none;}#repro-message--dialog--primary-button-text{background:black;color:white;margin-right:8px;}#repro-message--dialog--secondary-button-text{color:white;background:black;}#repro-message--dialog--close-button{cursor:pointer;position:absolute;right:0;padding-top:8px;padding-right:12px;}#repro-message--dialog-close-icon{width:14px;height:14px;background-color:transparent;}#repro-message--dialog-mdiv,#repro-message--dialog-md{height:14px;width:2px;background:black;}#repro-message--dialog-mdiv{margin-left:12px;transform:rotate(45deg);-ms-transform:rotate(45deg);/*IE9*/-webkit-transform:rotate(45deg);/*SafariandChrome*/Z-index:1;}#repro-message--dialog-md{transform:rotate(90deg);-ms-transform:rotate(90deg);/*IE9*/-webkit-transform:rotate(90deg);/*SafariandChrome*/Z-index:2;}@mediaonlyscreenand(max-width:748px){#repro-message--dialog--container{margin-top:0;max-width:90%;flex-direction:column;}#repro-message--dialog--header{max-height:75px;}#repro-message--dialog--body{max-height:52px;}#repro-message--dialog--image-container{min-height:246px;}#repro-message--dialog--button-container{display:flex;flex-direction:column;}#repro-message--dialog--primary-button-text,#repro-message--dialog--secondary-button-text{max-width:none;width:100%;}#repro-message--dialog--primary-button-text{margin-bottom:8px;}}#repro-message--dialog-mini--container{background:white;display:inline-flex;flex-direction:column;width:325px;z-index:1000;padding:0;margin:0;border:0;box-shadow:03px12pxrgba(27,31,35,0.15);position:fixed;}#repro-message--dialog-mini--container.left-top{left:24px;top:24px;}#repro-message--dialog-mini--container.left-bottom{left:24px;bottom:24px;}#repro-message--dialog-mini--container.right-top{right:24px;top:24px;left:auto;}#repro-message--dialog-mini--container.right-bottom{right:24px;bottom:24px;left:auto;}#repro-message--dialog-mini--content{display:flex;align-items:center;flex-direction:column;padding:12px;position:relative;}#repro-message--dialog-mini--upper{display:inline-flex;width:100%;}#repro-message--dialog-mini--image-container{display:flex;margin-right:12px;text-align:center;}#repro-message--dialog-mini--image{width:72px;height:auto;align-self:center;}#repro-message--dialog-mini--text{overflow:hidden;}#repro-message--dialog-mini--header{color:black;font-family:inherit;font-size:1em;line-height:1.2;font-weight:bold;margin-bottom:8px;max-height:96px;overflow:hidden;}#repro-message--dialog-mini--body{color:rgba(0,0,0,0.8);line-height:1.2;font-family:inherit;font-size:1em;max-height:76px;}#repro-message--dialog-mini--button-container{display:flex;flex-direction:column;align-items:flex-start;padding-top:12px;width:100%;}#repro-message--dialog-mini--primary-button-text,#repro-message--dialog-mini--secondary-button-text{border:1pxsolid#000;box-sizing:border-box;border-radius:6px;padding:8px14px;white-space:nowrap;cursor:pointer;text-align:center;user-select:none;width:100%;color:white;overflow:hidden;text-overflow:ellipsis;}#repro-message--dialog-mini--primary-button-text{background:black;margin-right:8px;margin-bottom:8px;}#repro-message--dialog-mini--secondary-button-text{background:black;}#repro-message--dialog-mini--close-button{cursor:pointer;position:absolute;right:0;top:0;padding-top:8px;padding-right:12px;}#repro-message--dialog-mini-close-icon{width:14px;height:14px;background-color:transparent;}#repro-message--dialog-mini-mdiv,#repro-message--dialog-mini-md{height:14px;width:2px;background:black;}#repro-message--dialog-mini-mdiv{margin-left:12px;transform:rotate(45deg);-ms-transform:rotate(45deg);-webkit-transform:rotate(45deg);z-index:1;}#repro-message--dialog-mini-md{transform:rotate(90deg);-ms-transform:rotate(90deg);-webkit-transform:rotate(90deg);z-index:2;}@mediaonlyscreenand(max-width:748px){#repro-message--dialog-mini--container{left:0!important;bottom:0!important;top:auto!important;right:auto!important;width:100%;}#repro-message--dialog-mini--text{padding-top:12px;}}#repro-message--dialog-image-only--container{background:white;cursor:pointer;display:inline-flex;margin-top:24px;max-width:90%;z-index:1000;padding:0;border:0;box-shadow:03px12pxrgba(27,31,35,0.15);position:relative;}#repro-message--dialog-image-only--image{align-self:center;max-width:100%;}#repro-message--dialog-image-only--close-button{position:absolute;right:0;padding-top:8px;padding-right:12px;}#repro-message--dialog-image-only-close-icon{width:14px;height:14px;background-color:transparent;}#repro-message--dialog-mdiv,#repro-message--dialog-image-only-md{height:14px;width:2px;background:black;}#repro-message--dialog-image-only-mdiv{margin-left:12px;transform:rotate(45deg);-ms-transform:rotate(45deg);-webkit-transform:rotate(45deg);z-index:1;}#repro-message--dialog-image-only-md{transform:rotate(90deg);-ms-transform:rotate(90deg);-webkit-transform:rotate(90deg);z-index:2;}#repro-message--banner--container{background:rgba(0,0,0,0.8);position:fixed;bottom:0;left:0;max-height:300px;min-height:84px;min-width:320px;padding-top:12px;width:100%;z-index:1000;}#repro-message--banner--content{display:flex;margin-right:auto;margin-left:auto;width:960px;}#repro-message--banner--upper{display:flex;}#repro-message--banner--image-container{display:flex;width:auto;}#repro-message--banner--image-containerimg{align-self:center;max-width:300px;height:auto;max-height:300px;height:72px;width:72px;}#repro-message--banner--text{padding:12px24px;width:100%;max-height:252px;overflow:hidden;}#repro-message--banner--header{color:white;font-family:inherit;font-size:1em;line-height:1.2;font-weight:bold;}#repro-message--banner--body{color:rgba(255,255,255,0.8);line-height:1.2;margin-top:8px;font-family:inherit;font-size:0.9em;}#repro-message--banner--button-container{display:inline-flex;align-items:flex-start;padding-top:24px;}#repro-message--banner--primary-button-text,#repro-message--banner--secondary-button-text{border:1pxsolid#000;box-sizing:border-box;border-radius:6px;max-width:230px;overflow:hidden;padding:9px16px;white-space:nowrap;cursor:pointer;text-align:center;text-overflow:ellipsis;user-select:none;}#repro-message--banner--primary-button-text{background:black;color:white;margin-right:8px;}#repro-message--banner--secondary-button-text{background:black;color:white;}#repro-message--banner--close-button{cursor:pointer;padding-top:8px;}#repro-message--banner-close-icon{width:24px;height:24px;background-color:transparent;}#repro-message--banner-mdiv,#repro-message--banner-md{height:18px;width:3px;background:white;}#repro-message--banner-mdiv{margin-left:12px;transform:rotate(45deg);-ms-transform:rotate(45deg);/*IE9*/-webkit-transform:rotate(45deg);/*SafariandChrome*/Z-index:1;}#repro-message--banner-md{transform:rotate(90deg);-ms-transform:rotate(90deg);/*IE9*/-webkit-transform:rotate(90deg);/*SafariandChrome*/Z-index:2;}@mediaonlyscreenand(max-width:960px){#repro-message--banner--content{max-width:100%;}#repro-message--banner--close-button{padding-right:8px;}#repro-message--banner--image-container{margin-left:24px;}display:flex;}@media(max-width:640px){#repro-message--banner--content{flex-direction:column;}#repro-message--banner--button-container{padding-top:8px;}#repro-message--banner--text{max-height:145px;padding-bottom:8px;padding-left:12px;}#repro-message--banner--button-container{display:flex;flex-direction:column;padding-left:12px;padding-right:12px;padding-bottom:12px;}#repro-message--banner--primary-button-text,#repro-message--banner--secondary-button-text{max-width:none;width:100%;}#repro-message--banner--secondary-button-text{margin-top:8px;}#repro-message--banner--close-button{position:absolute;right:0;top:0;}#repro-message--banner--image-container{margin-left:12px;}}`;\n\n\nclass Message {\n  renderFromTemplate() {\n    throw new Error('You must implement `renderFromTemplate` function!');\n  }\n\n  get containerCssSelector() {\n    throw new Error('You must implement `containerCssSelector` function!');\n  }\n\n  get closeButtonCssSelector() {\n    throw new Error('You must implement `closeButtonCssSelector` function!');\n  }\n\n  get primaryButtonCssSelector() {\n    throw new Error('You must implement `primaryButtonCssSelector` function!');\n  }\n\n  get secondaryButtonCssSelector() {\n    throw new Error('You must implement `secondaryButtonCssSelector` function!');\n  }\n\n  preloadImage() {\n    if (!this.imageUrl) return false;\n    const img = new Image();\n    img.src = this.imageUrl;\n    img.style.display = 'none';\n    img.style.visibility = 'hidden'; // making sure the image is not shown\n    document.body.appendChild(img);\n  }\n\n  show() {\n    if (this.isVisible) return false;\n\n    const container = document.createElement('div');\n    // TODO: アニメーションつける\n    container.innerHTML = this.renderFromTemplate();\n    this.domNode = container;\n    this.isVisible = true;\n    // TODO: delay時間をconfigurableにする\n    setTimeout(() => {\n      document.body.appendChild(container);\n    }, 1000);\n    this.tracker.clip.trackMessageDisplay(this.messageId, this.messageImpressionTrackId);\n\n    container.querySelector(this.closeButtonCssSelector).addEventListener('click', ev => {\n      ev.preventDefault();\n      this.dismiss();\n    });\n    if (this.primaryButtonText) {\n      container.querySelector(this.primaryButtonCssSelector).addEventListener('click', ev => {\n        ev.preventDefault();\n        this.clickButtonPrimary();\n      });\n    }\n    if (this.secondaryButtonText) {\n      container.querySelector(this.secondaryButtonCssSelector).addEventListener('click', ev => {\n        ev.preventDefault();\n        this.clickButtonSecondary();\n      });\n    }\n\n    // FIXME: 親classから子classでしか認知できないものの処理をするべきではないので、子class側で処理するようにする\n    if (this.type === 'Marketing::WebMessageDialogPanel' || this.type === 'Marketing::DialogImageOnlyWebMessagePanel') {\n      container.querySelector('#repro-message--dialog--closer').addEventListener('click', () => {\n        this.dismiss();\n      });\n    }\n\n    if (this.type === 'Marketing::DialogImageOnlyWebMessagePanel') {\n      container.querySelector(this.dialogImageOnlyCssSelector).addEventListener('click', ev => {\n        ev.preventDefault();\n        this.clickButtonPrimary();\n      });\n    }\n  }\n\n  dismiss() {\n    // 非表示じゃなくてDOMから消したほうが良い？\n    this.domNode.querySelector(this.containerCssSelector).style.display = 'none';\n    this.isVisible = false;\n    this.manager.hasVisibleMessage = false;\n    this.tracker.clip.trackMessageDisplay(this.messageId, this.closeButtonId);\n  }\n\n  clickButtonPrimary() {\n    // 非表示じゃなくてDOMから消したほうが良い？\n    this.domNode.querySelector(this.containerCssSelector).style.display = 'none';\n    this.isVisible = false;\n    this.manager.hasVisibleMessage = false;\n    this.tracker.clip.trackMessageDisplay(this.messageId, this.primaryButtonId);\n    if (this.primaryButtonEventName) {\n      this.tracker.track(this.primaryButtonEventName);\n    }\n  }\n\n  clickButtonSecondary() {\n    // 非表示じゃなくてDOMから消したほうが良い？\n    this.domNode.querySelector(this.containerCssSelector).style.display = 'none';\n    this.isVisible = false;\n    this.manager.hasVisibleMessage = false;\n    this.tracker.clip.trackMessageDisplay(this.messageId, this.secondaryButtonId);\n    if (this.secondaryButtonEventName) {\n      this.tracker.track(this.secondaryButtonEventName);\n    }\n  }\n\n  get headerStyles() {\n    return this.headerTextColor ? `color:${hex8ToRgba(this.headerTextColor)};` : '';\n  }\n\n  get bodyStyles() {\n    return this.bodyTextColor ? `color:${hex8ToRgba(this.bodyTextColor)};` : '';\n  }\n\n  get primaryButtonStyles() {\n    let style = '';\n    style += this.primaryButtonColor ? `color:${hex8ToRgba(this.primaryButtonColor)};` : '';\n    style += this.primaryButtonBgColor ? `background-color:${hex8ToRgba(this.primaryButtonBgColor)};` : '';\n    style += this.primaryButtonBorderColor ? `border-color:${hex8ToRgba(this.primaryButtonBorderColor)};` : '';\n    return style;\n  }\n\n  get secondaryButtonStyles() {\n    let style = '';\n    style += this.secondaryButtonColor ? `color:${hex8ToRgba(this.secondaryButtonColor)};` : '';\n    style += this.secondaryButtonBgColor ? `background-color:${hex8ToRgba(this.secondaryButtonBgColor)};` : '';\n    style += this.secondaryButtonBorderColor ? `border-color:${hex8ToRgba(this.secondaryButtonBorderColor)};` : '';\n    return style;\n  }\n\n  get closeButtonStyles() {\n    return this.closeIconColor ? `background-color:${hex8ToRgba(this.closeIconColor)};` : '';\n  }\n}\n\nclass DialogMessage extends Message {\n  constructor(message, manager, tracker) {\n    super();\n    this.manager = manager;\n    this.tracker = tracker;\n\n    this.messageId = message.id;\n    this.type = message.type;\n    this.windowBgColor = message.window_bg_color;\n    this.dialogColor = message.dialog_color;\n    this.messageImpressionTrackId = message.message_impression_track_id;\n    this.closeIconColor = message.close_icon_color;\n    this.closeButtonId = message.close_button_id;\n    this.header = message.header;\n    this.headerTextColor = message.header_text_color;\n    this.body = message.body;\n    this.bodyTextColor = message.body_text_color;\n    this.imageUrl = message.image_url;\n    this.primaryButtonText = message.primary_button_text;\n    this.primaryButtonColor = message.primary_button_color;\n    this.primaryButtonBgColor = message.primary_button_bg_color;\n    this.primaryButtonBorderColor = message.primary_button_border_color;\n    this.primaryButtonUrl = message.primary_button_url;\n    this.primaryButtonEventName = message.primary_button_event_name;\n    this.primaryButtonId = message.primary_button_id;\n    this.secondaryButtonText = message.secondary_button_text;\n    this.secondaryButtonColor = message.secondary_button_color;\n    this.secondaryButtonBgColor = message.secondary_button_bg_color;\n    this.secondaryButtonBorderColor = message.secondary_button_border_color;\n    this.secondaryButtonUrl = message.secondary_button_url;\n    this.secondaryButtonEventName = message.secondary_button_event_name;\n    this.secondaryButtonId = message.secondary_button_id;\n    this.position = message.position;\n    this.contentWidth = message.content_width;\n    this.triggerEventName = message.trigger_event_name;\n    this.domNode = null;\n\n    this.isVisible = false;\n  }\n\n  // TODO: ButtonUrlの有無でボタンをリンカブルにする\n  renderFromTemplate() {\n    let html = `<div id=\"repro-message--dialog--overlay-wrapper\" style=\"${this.overlayStyles}\"><div id=\"repro-message--dialog--closer\"></div><div id=\"repro-message--dialog--container\" style=\"${this.dialogStyles}\">`;\n    html += this.imageUrl ? `<div id=\"repro-message--dialog--image-container\" style=\"background-image:url(${this.imageUrl})\">` : '<div id=\"repro-message--dialog--image-container\">';\n    html += `</div><div id=\"repro-message--dialog--content\"><div id=\"repro-message--dialog--text\">`;\n    html += this.header ? `<div id=\"repro-message--dialog--header\" style=\"${this.headerStyles}\">${this.header}</div>` : '';\n    html += this.body ? `<div id=\"repro-message--dialog--body\" style=\"${this.bodyStyles}\">${this.body}</div>` : '';\n    html += '<div id=\"repro-message--dialog--button-container\">';\n    html += this.primaryButtonText ? `<div id=\"repro-message--dialog--primary-button-text\" style=\"${this.primaryButtonStyles}\">${this.primaryButtonText}</div>` : '';\n    html += this.secondaryButtonText ? `<div id=\"repro-message--dialog--secondary-button-text\" style=\"${this.secondaryButtonStyles}\">${this.secondaryButtonText}</div>` : '';\n    html += `</div></div></div><div id=\"repro-message--dialog--close-button\"><div id=\"repro-message--dialog-close-icon\"><div id=\"repro-message--dialog-mdiv\" style=\"${this.closeButtonStyles}\"><div id=\"repro-message--dialog-md\" style=\"${this.closeButtonStyles}\"></div></div></div></div></div>`;\n    return html;\n  }\n\n  get overlayStyles() {\n    let style = '';\n    style += this.windowBgColor ? `background-color:${hex8ToRgba(this.windowBgColor)};` : '';\n    return style;\n  }\n\n  get dialogStyles() {\n    let style = '';\n    style += this.dialogColor ? `background-color:${hex8ToRgba(this.dialogColor)};` : '';\n    return style;\n  }\n\n  // TODD: closeボタンのスタイリングはマークアップの見直しも含めてやる\n\n  get containerCssSelector() {\n    return '#repro-message--dialog--overlay-wrapper';\n  }\n\n  get closeButtonCssSelector() {\n    return '#repro-message--dialog--close-button';\n  }\n\n  get primaryButtonCssSelector() {\n    return '#repro-message--dialog--primary-button-text';\n  }\n\n  get secondaryButtonCssSelector() {\n    return '#repro-message--dialog--secondary-button-text';\n  }\n}\n\nclass DialogMiniMessage extends Message {\n  constructor(message, manager, tracker) {\n    super();\n    this.manager = manager;\n    this.tracker = tracker;\n\n    this.messageId = message.id;\n    this.type = message.type;\n    this.dialogColor = message.dialog_color;\n    this.messageImpressionTrackId = message.message_impression_track_id;\n    this.closeIconColor = message.close_icon_color;\n    this.closeButtonId = message.close_button_id;\n    this.header = message.header;\n    this.headerTextColor = message.header_text_color;\n    this.body = message.body;\n    this.bodyTextColor = message.body_text_color;\n    this.imageUrl = message.image_url;\n    this.primaryButtonText = message.primary_button_text;\n    this.primaryButtonColor = message.primary_button_color;\n    this.primaryButtonBgColor = message.primary_button_bg_color;\n    this.primaryButtonBorderColor = message.primary_button_border_color;\n    this.primaryButtonUrl = message.primary_button_url;\n    this.primaryButtonEventName = message.primary_button_event_name;\n    this.primaryButtonId = message.primary_button_id;\n    this.secondaryButtonText = message.secondary_button_text;\n    this.secondaryButtonColor = message.secondary_button_color;\n    this.secondaryButtonBgColor = message.secondary_button_bg_color;\n    this.secondaryButtonBorderColor = message.secondary_button_border_color;\n    this.secondaryButtonUrl = message.secondary_button_url;\n    this.secondaryButtonEventName = message.secondary_button_event_name;\n    this.secondaryButtonId = message.secondary_button_id;\n    this.position = message.position;\n    this.contentWidth = message.content_width;\n    this.triggerEventName = message.trigger_event_name;\n    this.domNode = null;\n\n    this.isVisible = false;\n  }\n\n  // TODO: ButtonUrlの有無でボタンをリンカブルにする\n  renderFromTemplate() {\n    let html = `<div id=\"repro-message--dialog-mini--container\"  class=\"${this.position}\" style=\"${this.dialogMiniStyles}\"><div id=\"repro-message--dialog-mini--content\"><div id=\"repro-message--dialog-mini--upper\"><div id=\"repro-message--dialog-mini--image-container\">`;\n    html += this.imageUrl ? `<img id=\"repro-message--dialog-mini--image\" src=\"${this.imageUrl}\">` : '';\n    html += '</div><div id=\"repro-message--dialog-mini--text\">';\n    html += this.header ? `<div id=\"repro-message--dialog-mini--header\" style=\"${this.headerStyles}\">${this.header}</div>` : '';\n    html += this.body ? `<div id=\"repro-message--dialog-mini--body\" style=\"${this.bodyStyles}\">${this.body}</div>` : '';\n    html += '</div></div><div id=\"repro-message--dialog-mini--button-container\">';\n    html += this.primaryButtonText ? `<div id=\"repro-message--dialog-mini--primary-button-text\" style=\"${this.primaryButtonStyles}\">${this.primaryButtonText}</div>` : '';\n    html += this.secondaryButtonText ? `<div id=\"repro-message--dialog-mini--secondary-button-text\" style=\"${this.secondaryButtonStyles}\">${this.secondaryButtonText}</div>` : '';\n    html += `</div><div id=\"repro-message--dialog-mini--close-button\"><div id=\"repro-message--dialog-mini-close-icon\"><div id=\"repro-message--dialog-mini-mdiv\" style=\"${this.closeButtonStyles}\"><div id=\"repro-message--dialog-mini-md\" style=\"${this.closeButtonStyles}\"></div></div></div></div></div></div>`;\n    return html;\n  }\n\n  get dialogMiniStyles() {\n    let style = '';\n    style += this.dialogColor ? `background-color:${hex8ToRgba(this.dialogColor)};` : '';\n    return style;\n  }\n\n  // TODD: closeボタンのスタイリングはマークアップの見直しも含めてやる\n\n  get containerCssSelector() {\n    return '#repro-message--dialog-mini--container';\n  }\n\n  get closeButtonCssSelector() {\n    return '#repro-message--dialog-mini--close-button';\n  }\n\n  get primaryButtonCssSelector() {\n    return '#repro-message--dialog-mini--primary-button-text';\n  }\n\n  get secondaryButtonCssSelector() {\n    return '#repro-message--dialog-mini--secondary-button-text';\n  }\n}\n\nclass DialogImageOnlyMessage extends Message {\n  constructor(message, manager, tracker) {\n    super();\n    this.manager = manager;\n    this.tracker = tracker;\n\n    this.messageId = message.id;\n    this.type = message.type;\n    this.windowBgColor = message.window_bg_color;\n    this.messageImpressionTrackId = message.message_impression_track_id;\n    this.closeIconColor = message.close_icon_color;\n    this.closeButtonId = message.close_button_id;\n    this.imageUrl = message.image_url;\n    this.primaryButtonUrl = message.primary_button_url;\n    this.primaryButtonEventName = message.primary_button_event_name;\n    this.primaryButtonId = message.primary_button_id;\n    this.contentWidth = message.content_width;\n    this.triggerEventName = message.trigger_event_name;\n    this.domNode = null;\n\n    this.isVisible = false;\n  }\n\n  renderFromTemplate() {\n    let html = `<div id=\"repro-message--dialog--overlay-wrapper\" style=\"${this.overlayStyles}\"><div id=\"repro-message--dialog--closer\"></div>`;\n    html += this.primaryButtonUrl ? `<a id=\"repro-message--dialog-image-only--container\" href=\"${this.primaryButtonUrl}\">` : '<div id=\"repro-message--dialog-image-only--container\">';\n    html += `<img id=\"repro-message--dialog-image-only--image\" src=\"${this.imageUrl}\"><div id=\"repro-message--dialog-image-only--close-button\"><div id=\"repro-message--dialog-image-only-close-icon\"><div id=\"repro-message--dialog-image-only-mdiv\" style=\"${this.closeButtonStyles}\"><div id=\"repro-message--dialog-image-only-md\" style=\"${this.closeButtonStyles}\"></div></div></div></div></div>`;\n    html += `</div>\n    `;\n    return html;\n  }\n\n  get overlayStyles() {\n    let style = '';\n    style += this.windowBgColor ? `background-color:${hex8ToRgba(this.windowBgColor)};` : '';\n    return style;\n  }\n\n  // TODD: closeボタンのスタイリングはマークアップの見直しも含めてやる\n\n  get containerCssSelector() {\n    return '#repro-message--dialog--overlay-wrapper';\n  }\n\n  get closeButtonCssSelector() {\n    return '#repro-message--dialog-image-only--close-button';\n  }\n\n  get dialogImageOnlyCssSelector() {\n    return '#repro-message--dialog-image-only--image';\n  }\n}\n\nclass BannerMessage extends Message {\n  constructor(message, manager, tracker) {\n    super();\n    this.manager = manager;\n    this.tracker = tracker;\n\n    this.messageId = message.id;\n    this.type = message.type;\n    this.bannerColor = message.banner_color;\n    this.messageImpressionTrackId = message.message_impression_track_id;\n    this.closeIconColor = message.close_icon_color;\n    this.closeButtonId = message.close_button_id;\n    this.header = message.header;\n    this.headerTextColor = message.header_text_color;\n    this.body = message.body;\n    this.bodyTextColor = message.body_text_color;\n    this.imageUrl = message.image_url;\n    this.primaryButtonText = message.primary_button_text;\n    this.primaryButtonColor = message.primary_button_color;\n    this.primaryButtonBgColor = message.primary_button_bg_color;\n    this.primaryButtonBorderColor = message.primary_button_border_color;\n    this.primaryButtonUrl = message.primary_button_url;\n    this.primaryButtonEventName = message.primary_button_event_name;\n    this.primaryButtonId = message.primary_button_id;\n    this.secondaryButtonText = message.secondary_button_text;\n    this.secondaryButtonColor = message.secondary_button_color;\n    this.secondaryButtonBgColor = message.secondary_button_bg_color;\n    this.secondaryButtonBorderColor = message.secondary_button_border_color;\n    this.secondaryButtonUrl = message.secondary_button_url;\n    this.secondaryButtonEventName = message.secondary_button_event_name;\n    this.secondaryButtonId = message.secondary_button_id;\n    this.position = message.position;\n    this.contentWidth = message.content_width;\n    this.triggerEventName = message.trigger_event_name;\n    this.domNode = null;\n\n    this.isVisible = false;\n  }\n\n  // TODO: ButtonUrlの有無でボタンをリンカブルにする\n  renderFromTemplate() {\n    let html = `<div id=\"repro-message--banner--container\" style=\"${this.bannerStyle}\"><div id=\"repro-message--banner--content\"><div id=\"repro-message--banner--upper\"><div id=\"repro-message--banner--image-container\">`;\n    html += this.imageUrl ? `<img id=\"repro-message---banner--image\" src=\"${this.imageUrl}\">` : '';\n    html += '</div><div id=\"repro-message--banner--text\">';\n    html += this.header ? `<div id=\"repro-message--banner--header\" style=\"${this.headerStyles}\">${this.header}</div>` : '';\n    html += this.body ? `<div id=\"repro-message--banner--body\" style=\"${this.bodyStyles}\">${this.body}</div>` : '';\n    html += '</div></div><div id=\"repro-message--banner--button-container\">';\n    html += this.primaryButtonText ? `<div id=\"repro-message--banner--primary-button-text\" style=\"${this.primaryButtonStyles}\">${this.primaryButtonText}</div>` : '';\n    html += this.secondaryButtonText ? `<div id=\"repro-message--banner--secondary-button-text\" style=\"${this.secondaryButtonStyles}\">${this.secondaryButtonText}</div>` : '';\n    html += `</div><div id=\"repro-message--banner--close-button\"><div id=\"repro-message--banner-close-icon\"><div id=\"repro-message--banner-mdiv\" style=\"${this.closeButtonStyles}\"><div id=\"repro-message--banner-md\" style=\"${this.closeButtonStyles}\"></div></div></div></div></div></div>`;\n    return html;\n  }\n\n  get bannerStyle() {\n    let style = '';\n    style += this.bannerColor ? `background-color:${hex8ToRgba(this.bannerColor)};` : '';\n    return style;\n  }\n\n  // TODD: closeボタンのスタイリングはマークアップの見直しも含めてやる\n\n  get containerCssSelector() {\n    return '#repro-message--banner--container';\n  }\n\n  get closeButtonCssSelector() {\n    return '#repro-message--banner--close-button';\n  }\n\n  get primaryButtonCssSelector() {\n    return '#repro-message--banner--primary-button-text';\n  }\n\n  get secondaryButtonCssSelector() {\n    return '#repro-message--banner--secondary-button-text';\n  }\n}\n\n// TODO: spec追加\nexport default class MessageManager {\n  constructor(tracker) {\n    this.messages = [];\n    this.tracker = tracker;\n    this.hasVisibleMessage = false;\n    this.generateStyleElement();\n  }\n\n  generateStyleElement() {\n    document.addEventListener('DOMContentLoaded', () => {\n      const styleElement = document.createElement('style');\n      styleElement.innerHTML = messageStyles;\n      document.body.appendChild(styleElement);\n    });\n  }\n\n  buildMessages(messages = []) {\n    // debugger\n    return messages.forEach(message => {\n      let msg;\n      Object.assign(message.panels[0], {\n        trigger_event_name: '初回起動3'\n      })\n      // switch (message.type) {\n      switch (message.kind) {\n        // case 'Marketing::WebMessageBannerPanel':\n        case 'banner':\n          msg = new BannerMessage(message.panels[0], this, this.tracker);\n          break;\n        case 'Marketing::WebMessageDialogPanel':\n          msg = new DialogMessage(message.panels[0], this, this.tracker);\n          break;\n        case 'Marketing::DialogMiniWebMessagePanel':\n          msg = new DialogMiniMessage(message.panels[0], this, this.tracker);\n          break;\n        case 'Marketing::DialogImageOnlyWebMessagePanel':\n          msg = new DialogImageOnlyMessage(message.panels[0], this, this.tracker);\n          break;\n        default:\n          console.warn('Unrecognized type is given, aborting message generation.');\n          return;\n      }\n      this.messages.push(msg);\n      this.tracker.subscribe(this, this.showTriggeredMessage);\n      if (msg.imageUrl) {\n        msg.preloadImage();\n      }\n    });\n  }\n\n  showTriggeredMessage(ev) {\n    // TODO: evをTS化したい\n    if (!ev || !ev.name) return false;\n    // Avoid showing multiple messages at the same time\n    if (this.hasVisibleMessage) return false;\n\n    const message = this.messages.find(msg => msg.triggerEventName === ev.name && !this.shownMessages[msg.messageId]);\n\n    if (message) {\n      message.show();\n      this.hasVisibleMessage = true;\n      this.storeShownMessage(message, formatDate(new Date(), true));\n      const idx = this.messages.indexOf(message);\n      this.messages.splice(idx, 1);\n      this.tracker.unsubscribe(this);\n    }\n  }\n\n  hideVisibleMessage() {\n    const shownMessage = this.messages.find(msg => msg.isVisible);\n    if (shownMessage) {\n      shownMessage.dismiss();\n    }\n  }\n\n  get shownMessages() {\n    try {\n      const val = ls.get(SHOWN_MESSAGES_STORAGE_KEY(this.tracker.config.token)) || '{}';\n      return JSON.parse(val);\n    } catch (_) {\n      return {};\n    }\n  }\n\n  storeShownMessage(message, tracked_at) {\n    const val = this.shownMessages;\n    // TODO: 古くなったmessageをlocalstorageから消す\n    val[message.messageId] = {\n      id: message.messageId,\n      tracked_at,\n    };\n    ls.set(SHOWN_MESSAGES_STORAGE_KEY(this.tracker.config.token), JSON.stringify(val));\n  }\n}\n","import { formatDate } from './util';\n\n// sendBeacon() を使って送信できるペイロードのサイズに上限があるので、上限に達する前にデータを送る必要がある。\n// 上限は仕様では決まっていないものの、多くのブラウザで64KBとなっているので、これを上限とする。\n// また clip として送信するデータの上限を64KBにしてしまうと、今後送るべきペイロードが増えた場合に対応できなくなってしまうので\n// イベントで24KBを上限として、この上限に達した際にはその時点でclipをアップロードする。\nconst maxCustomEventPayloadSize = 24 * 1024;\n\nclass Clip {\n  constructor(tracker) {\n    this.events = [];\n    // Clip クラスの責務をイベント／プロフィールの保持とペイロード上限のチェックに集中させるため、\n    // 実際にアップロードを行う ReproTracker#uploadClip の処理は外からもらう\n    this.tracker = tracker;\n    this.userProfiles = {};\n    this.messages = [];\n  }\n  addCustomEvent(customEvent) {\n    this.events.push(customEvent);\n    if (this.customEventPayloadSize >= maxCustomEventPayloadSize) {\n      this.tracker.uploadClip();\n    }\n  }\n  trackMessageDisplay(id, clicked_button_id) {\n    const entry = {\n      id,\n      clicked_button_id,\n      tracked_at: formatDate(new Date(), true),\n    };\n\n    this.messages.push(entry);\n  }\n  emptyEvents() {\n    this.events = [];\n  }\n  setUserProfile(type, key, value) {\n    this.userProfiles[key] = { type, value };\n    this.tracker.uploadClip();\n  }\n  byteLength(str) {\n    // taken from: https://gist.github.com/lovasoa/11357947\n    // returns the byte length of an UTF8 string\n    let n = str.length;\n    for (let i = n - 1; i >= 0; i -= 1) {\n      const code = str.charCodeAt(i);\n      if (code > 0x7f && code <= 0x7ff) {\n        n += 1;\n      } else if (code > 0x7ff && code <= 0xffff) {\n        n += 2;\n      }\n      if (code >= 0xDC00 && code <= 0xDFFF) {\n        i -= 1; // trail surrogate\n      }\n    }\n    return n;\n  }\n  get customEventPayloadSize() {\n    return this.byteLength(JSON.stringify(this.events));\n  }\n}\n\nexport default Clip;\n","import cookie from 'js-cookie';\nimport platform from 'platform';\nimport { version } from '../package.json' // eslint-disable-line\nimport { formatDate } from './util';\nimport uuid from './uuid';\n\nimport {\n  USER_ID_COOKIE_KEY,\n  EVENT_NAME_LENGTH_MAX,\n  EVENT_PROPERTIES_MAX,\n  EVENT_PROPERTY_NAME_MAX,\n  STANDARD_EVENT_PREFIX,\n  USER_PROFILE_KEY_LENGTH_MAX,\n  USER_PROFILE_VALUE_LENGTH_MAX,\n  STANDARD_USER_PROFILE_PREFIX,\n} from './constants';\n\nimport SessionManager from './session-manager';\nimport Configuration from './configuration';\nimport MessageManager from './message-manager';\nimport Clip from './clip';\n\n// tracker logic\n// TODO: tsファイル作らないにしても、clipオブジェクトの構造とか各関数tsで書きたい\nconst clipSchema = {\n  token: '',\n  bundle_id: '',\n  idfa: '',\n  idfv: '',\n  user_annotation: '',\n  push_token: '',\n  ip_address: '',\n  app_version: '',\n  sdk_version: '',\n  os: '',\n  os_version: '',\n  device: '',\n  network: '',\n  height: 0,\n  width: 0,\n  production: false,\n  push_enabled: false,\n  started_at: '',\n  ended_at: '',\n};\n\n\n// TODO: 全体をtry cathで囲んで、万が一エラーがあっても何も実行されないようにしたい。特にSPA系のサイトだとJSがエラーになることでサイトそのものの機能に巻き添え食らわすと最悪\nexport default class ReproTracker {\n  constructor() {\n    this.config = {\n      api_host: '',\n      token: '',\n    };\n    this.user_annotation = '';\n    this.idfv = '';\n    this.isFirstLaunch = false;\n\n    const now = new Date();\n    this.started_at = formatDate(now, true);\n\n    this.configuration = new Configuration();\n    this.subscribers = [];\n    this.messageManager = new MessageManager(this);\n    this.sessionManager = new SessionManager();\n    this.clip = new Clip(this);\n\n    this.isInitialized = false;\n  }\n\n  subscribe(target, callback) {\n    this.subscribers.push({ target, callback });\n  }\n\n  unsubscribe(targetSubscriber) {\n    const idx = this.subscribers.findIndex(sub => sub.target === targetSubscriber);\n    this.subscribers.splice(idx, 1);\n  }\n\n  notifyEvent(ev) {\n    this.subscribers.forEach(sub => {\n      sub.callback.call(sub.target, ev);\n    });\n  }\n\n  init(config) {\n    // TODO: tokenとapi_hostのvalidation\n    this.config.api_host = config.api_host || 'https://6gp3biaq8d.execute-api.ap-northeast-1.amazonaws.com/active/upload';\n    this.config.token = config.token;\n\n    this.isInitialized = true;\n\n    const userId = cookie.get(USER_ID_COOKIE_KEY);\n    if (!userId) {\n      this.isFirstLaunch = true;\n      this.track('pageFirstView');\n      cookie.set(USER_ID_COOKIE_KEY, uuid());\n    }\n    this.idfv = cookie.get(USER_ID_COOKIE_KEY);\n\n    // TODO: configはpage loadのたびじゃなくてsession単位で実行して保持しておけば良いかも\n    this.configuration.call({\n      user_annotation: this.user_annotation,\n      idfv: this.idfv,\n      isFirstLaunch: this.isFirstLaunch,\n      token: this.config.token,\n    })\n      .then(configuration => {\n        const now = new Date();\n        if (configuration.trackable && this.sessionManager.isNewSession(now)) {\n          this.trackNewSession();\n          this.sessionManager.updateLastEventTrackedAt(now);\n        }\n        if (configuration.shouldClearCustomEvents) {\n          this.custom_events = [];\n        }\n        if (configuration.messages.length > 0) {\n          this.messageManager.buildMessages(configuration.messages);\n        }\n      })\n      .catch(err => console.warn(err));\n  }\n\n  // FIXME: 標準イベント対応\n  track(name, properties = {}) {\n    if (!this.configuration.trackable || !this.validateEventName(name) || !this.validateEventProperties(properties)) {\n      return false;\n    }\n\n    const now = new Date();\n    if (this.sessionManager.isNewSession(now)) {\n      this.trackNewSession();\n    }\n\n    // FIXME: event_name, property.name, property.value の lengthのvalidationが必要\n    // https://repro.esa.io/posts/8857#2-8-0\n    // eventオブジェクトをTS化したい\n    const event = {\n      name,\n      properties,\n      // configでもらった responded_at をもとに時刻のズレを修正する必要あり？\n      tracked_at: formatDate(now, true),\n    };\n    this.notifyEvent(event);\n    this.clip.addCustomEvent(event);\n    this.sessionManager.updateLastEventTrackedAt(now);\n  }\n\n  trackNewSession() {\n    if (!this.configuration.trackable) {\n      return false;\n    }\n    const now = new Date();\n    this.clip.addCustomEvent({\n      name: 'sessionStarted',\n      properties: {},\n      tracked_at: formatDate(now, true),\n    });\n    this.sessionManager.updatecurrentSessionStartedAt(now);\n  }\n\n  // TODO: ユーザーがanonymousから同定されたタイミングでいちどデータをアップロードしてセッションを終了した方が良いらしい\n  setUserId(value) {\n    this.user_annotation = value;\n  }\n\n  // TODO: 型が違う場合の例外処理\n  setStringUserProfile(key, value) {\n    if (!this.validateUserProfileKey(key) || !this.validateUserProfileValue(value)) return false;\n    this.clip.setUserProfile('string', key, value);\n  }\n  setIntUserProfile(key, value) {\n    if (!this.validateUserProfileKey(key) || !this.validateUserProfileValue(value)) return false;\n    this.clip.setUserProfile('int', key, value);\n  }\n  setDoubleUserProfile(key, value) {\n    if (!this.validateUserProfileKey(key) || !this.validateUserProfileValue(value)) return false;\n    this.clip.setUserProfile('decimal', key, value);\n  }\n  setDateUserProfile(key, value) {\n    if (!this.validateUserProfileKey(key) || !this.validateUserProfileValue(value)) return false;\n    this.clip.setUserProfile('datetime', key, value);\n  }\n\n  hideMessage() {\n    this.messageManager.hideVisibleMessage();\n  }\n\n  get clipJSON() {\n    const clip = Object.assign(clipSchema, {\n      token: this.config.token,\n      user_annotation: this.user_annotation,\n      started_at: this.started_at,\n      idfv: this.idfv,\n      ip_address: this.configuration.ipAddress,\n      ended_at: this.ended_at,\n\n      height: window.innerHeight,\n      width: window.innerWidth,\n      bundle_id: location.host,\n      device: navigator.platform,\n      network: ('connection' in navigator ? navigator.connection.effectiveType : 'unknown'),\n      sdk_version: version,\n      os: 'web',\n      os_version: `${platform.os.family} ${platform.os.version}`,\n      push_enabled: ('permission' in Notification && Notification.permission === 'granted'), // TODO: fix when implementing push receiver in sw\n    });\n\n    return Object.assign({}, {\n      custom_event: this.clip.events,\n      user: this.clip.userProfiles,\n      in_app_messages: this.clip.messages,\n      clip,\n    });\n  }\n\n  uploadClip() {\n    // TODO: tokenとapi_hostのvalidation\n\n    if (!this.isInitialized) {\n      console.warn('Tracker not initialized yet!');\n      return false;\n    }\n    if (!this.configuration.configured) {\n      console.warn('Configuration not done yet!');\n      // TODO: このときはローカルにcustom eventsを保持しておくべき？\n      return false;\n    }\n\n    if (!this.configuration.trackable) {\n      console.warn('Tracking is not permitted!');\n      return false;\n    }\n\n    const filename = `${this.config.token}_${this.idfv}_${formatDate(new Date())}.json`;\n    this.ended_at = formatDate(new Date(), true);\n\n    if ('sendBeacon' in navigator) {\n      navigator.sendBeacon(this.config.api_host, JSON.stringify({\n        filename,\n        clip: this.clipJSON,\n      }));\n    } else {\n      const request = new XMLHttpRequest();\n      request.open('POST', this.config.api_host, false); // make XHR synchronous\n      request.send(JSON.stringify({\n        filename,\n        clip: this.clipJSON,\n      }));\n      // TODO: error handling\n    }\n\n    this.clip.emptyEvents();\n    this.started_at = formatDate(new Date());\n    this.ended_at = '';\n  }\n\n  validateEventName(name) {\n    if (typeof (name) !== 'string') {\n      console.error(\"Didn't track event: Event name must be string.\");\n      return false;\n    }\n    if (!name) {\n      console.error(\"Didn't track event: Event name can't be blank.\");\n      return false;\n    }\n    if (name.length > EVENT_NAME_LENGTH_MAX) {\n      console.error(`Didn't track event: Event name must be ${EVENT_NAME_LENGTH_MAX} characters or less; your current event name is \"${name}\".`);\n      return false;\n    }\n    if (name.startsWith(STANDARD_EVENT_PREFIX)) {\n      console.error(`Didn't track event: Event name can't start with '${STANDARD_EVENT_PREFIX}'; your current event name is \"${name}\".`);\n      return false;\n    }\n    return true;\n  }\n\n  validateEventProperties(properties) {\n    if (properties === null) return true;\n    const propertyKeys = Object.keys(properties);\n    for (let i = 0; i < propertyKeys.length; i += 1) {\n      const propertyKey = propertyKeys[i];\n      if (!!properties.null || !propertyKey) {\n        console.error(\"Didn't track event: Property name can't be blank.\");\n        return false;\n      }\n      if (propertyKey.length > EVENT_PROPERTY_NAME_MAX) {\n        console.error(`Didn't track event: Property name must be ${EVENT_PROPERTY_NAME_MAX} characters or less; your current property name is \"${propertyKey}\".`);\n        return false;\n      }\n    }\n    if (propertyKeys.length > EVENT_PROPERTIES_MAX) {\n      console.error(`Didn't track event: The number of properties must be less than ${EVENT_PROPERTIES_MAX}; you currently have \"${Object.keys(properties).length}\" set.`);\n      return false;\n    }\n    return true;\n  }\n\n  validateUserProfileKey(key) {\n    if (typeof (key) !== 'string') {\n      console.error(`Validation failed for User Profile: key = \"${key}\": The key of User Profile must be string`);\n      return false;\n    }\n    if (!key) {\n      console.error(`Validation failed for User Profile: key = \"${key}\": The key of User Profile can't be empty`);\n      return false;\n    }\n    if (key.startsWith(STANDARD_USER_PROFILE_PREFIX)) {\n      console.error(`Validation failed for User Profile: key = \"${key}\": The key of User Profile can't start with \"${STANDARD_USER_PROFILE_PREFIX}\"`);\n      return false;\n    }\n    if (key.length > USER_PROFILE_KEY_LENGTH_MAX) {\n      console.error(`Validation failed for User Profile: key = \"${key}\": The length of the key of User Profile must be lower than or equals to ${USER_PROFILE_KEY_LENGTH_MAX}`);\n      return false;\n    }\n    return true;\n  }\n\n  validateUserProfileValue(value) {\n    if (!value) {\n      console.error(`Validation failed for User Profile: value = \"${value}\": The value of User Profile can't be null`);\n      return false;\n    }\n    if (value.length > USER_PROFILE_VALUE_LENGTH_MAX) {\n      console.error(`Validation failed for User Profile: value = \"${value}\": The length of the value of User Profile must be lower than or equals to ${USER_PROFILE_VALUE_LENGTH_MAX}`);\n      return false;\n    }\n    return true;\n  }\n}\n\n// export\nwindow.reproio = new ReproTracker();\n\n// TODO: 各イベントのブラウザ互換性\ndocument.addEventListener('DOMContentLoaded', () => {\n  window.reproio.track('pageView', {\n    url: location.pathname,\n  });\n\n  // TODO: link trackerのロジックが複雑になったらクラス分ける\n  const { links } = document;\n  // FIXME: for of で書くとrollupのtranspile設定が悪いからか動かなかったので直す\n  for (let i = 0; i < links.length; i += 1) {\n    const a = links[i];\n    a.addEventListener('click', e => {\n      window.reproio.track('linkClick', {\n        href: e.currentTarget.href,\n      });\n    });\n  }\n});\n\n// detect URL change done by history.pushState() and hide shown message\nconst { pushState } = history;\nif (history.pushState && history.state !== undefined) {\n  history.pushState = function newPushState() {\n    window.reproio.hideMessage();\n    pushState.apply(window.history, arguments); // eslint-disable-line prefer-rest-params\n  };\n}\n\nwindow.addEventListener('beforeunload', () => {\n  window.reproio.uploadClip();\n});\n"],"names":["factory","module","OldCookies","window","Cookies","api","noConflict","extend","i","result","arguments","length","attributes","key","init","converter","value","document","path","defaults","expires","Date","setMilliseconds","getMilliseconds","toUTCString","JSON","stringify","test","e","write","encodeURIComponent","String","replace","decodeURIComponent","escape","stringifiedAttributes","attributeName","cookie","cookies","split","rdecode","parts","slice","join","this","json","charAt","name","read","parse","set","get","call","getJSON","apply","remove","withConverter","objectTypes","function","object","root","freeExports","exports","freeModule","nodeType","freeGlobal","global","self","maxSafeInteger","Math","pow","reOpera","objectProto","Object","prototype","hasOwnProperty","toString","capitalize","string","toUpperCase","format","trim","forOwn","callback","getClassOf","qualify","reduce","array","accumulator","index","each","platform","ua","context","isCustomContext","nav","navigator","userAgent","data","isSpecialCasedOS","property","type","likeChrome","airRuntimeClass","enviroClass","javaClass","java","phantomClass","rhino","environment","alpha","beta","doc","opera","operamini","operaClass","arch","description","prerelease","useFeatures","version","layout","label","pattern","guess","RegExp","exec","guesses","getName","product","getProduct","manufacturer","getManufacturer","Apple","iPad","iPhone","iPod","Archos","Amazon","Kindle","Kindle Fire","Asus","Transformer","Barnes & Noble","Nook","BlackBerry","PlayBook","Google","Google TV","Nexus","HP","TouchPad","HTC","LG","Microsoft","Xbox","Xbox One","Motorola","Xoom","Nintendo","Wii U","Wii","Nokia","Lumia","Samsung","Galaxy S","Galaxy S2","Galaxy S3","Galaxy S4","Sony","PlayStation","PlayStation Vita","os","10.0","6.4","6.3","6.2","6.1","6.0","5.2","5.1","5.01","5.0","4.0","4.90","cleanupOS","getOS","push","unshift","indexOf","parseFloat","runtime","flash","system","Capabilities","phantom","major","minor","patch","documentMode","toFixed","lang","System","getProperty","require","process","browser","versions","electron","node","nw","appMinorVersion","external","parseInt","architecture","family","cpuClass","formatDate","date","timezone","year","getFullYear","month","getMonth","dates","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","millisec","rawOffset","getTimezoneOffset","sign","offsetStr","abs","getTimezoneOffsetString","ls","localStorage","getItem","val","setItem","warn","hex8ToRgba","hex8","hex8Array","match","rgbaText","map","x","Number","includes","NaN","r","n","o","t","u","f","s","d","Error","code","a","1","substr","2","crypto","getRandomValues","bind","msCrypto","Uint8Array","Array","random","3","c","l","clockseq","v","p","msecs","getTime","y","nsecs","m","b","w","./lib/bytesToUuid","./lib/rng","SHOWN_MESSAGES_STORAGE_KEY","token","SessionManager","now","lastEventTrackedAt","currentSessionstartedAt","currentSessionExpireAt","updatecurrentSessionStartedAt","epoch","isNaN","epochToDate","setTimeoutFunc","setTimeout","noop","Promise","fn","TypeError","_state","_handled","_value","undefined","_deferreds","doResolve","handle","deferred","_immediateFn","cb","onFulfilled","onRejected","ret","reject","promise","resolve","newValue","then","finale","thisArg","_unhandledRejectionFn","len","done","reason","ex","prom","constructor","all","arr","args","remaining","res","race","values","setImmediate","err","console","CONFIGURATION_URL","Configuration","response","appId","trackable","configured","ipAddress","messages","params","some","prop","onLine","user_annotation","idfv","isFirstLaunch","fetch","Content-Type","_this","ok","statusText","insight","app_id","ip_address","web_messages","catch","status","xhr","XMLHttpRequest","onload","body","responseText","onerror","ontimeout","open","setRequestHeader","withCredentials","send","Message","imageUrl","img","Image","src","style","display","visibility","appendChild","isVisible","container","createElement","innerHTML","renderFromTemplate","domNode","tracker","clip","trackMessageDisplay","messageId","messageImpressionTrackId","querySelector","closeButtonCssSelector","addEventListener","preventDefault","dismiss","primaryButtonText","primaryButtonCssSelector","clickButtonPrimary","secondaryButtonText","secondaryButtonCssSelector","clickButtonSecondary","dialogImageOnlyCssSelector","containerCssSelector","manager","hasVisibleMessage","closeButtonId","primaryButtonId","primaryButtonEventName","track","secondaryButtonId","secondaryButtonEventName","headerTextColor","bodyTextColor","primaryButtonColor","primaryButtonBgColor","primaryButtonBorderColor","secondaryButtonColor","secondaryButtonBgColor","secondaryButtonBorderColor","closeIconColor","DialogMessage","message","id","windowBgColor","window_bg_color","dialogColor","dialog_color","message_impression_track_id","close_icon_color","close_button_id","header","header_text_color","body_text_color","image_url","primary_button_text","primary_button_color","primary_button_bg_color","primary_button_border_color","primaryButtonUrl","primary_button_url","primary_button_event_name","primary_button_id","secondary_button_text","secondary_button_color","secondary_button_bg_color","secondary_button_border_color","secondaryButtonUrl","secondary_button_url","secondary_button_event_name","secondary_button_id","position","contentWidth","content_width","triggerEventName","trigger_event_name","html","overlayStyles","dialogStyles","headerStyles","bodyStyles","primaryButtonStyles","secondaryButtonStyles","closeButtonStyles","DialogMiniMessage","dialogMiniStyles","DialogImageOnlyMessage","BannerMessage","bannerColor","banner_color","bannerStyle","MessageManager","generateStyleElement","styleElement","forEach","msg","panels","kind","_this6","subscribe","showTriggeredMessage","preloadImage","ev","find","_this7","shownMessages","show","storeShownMessage","idx","splice","unsubscribe","shownMessage","tracked_at","config","_","Clip","events","userProfiles","customEvent","customEventPayloadSize","uploadClip","clicked_button_id","entry","str","charCodeAt","byteLength","clipSchema","ReproTracker","started_at","configuration","subscribers","messageManager","sessionManager","isInitialized","target","targetSubscriber","findIndex","sub","api_host","uuid","isNewSession","trackNewSession","updateLastEventTrackedAt","shouldClearCustomEvents","custom_events","buildMessages","properties","validateEventName","validateEventProperties","event","notifyEvent","addCustomEvent","validateUserProfileKey","validateUserProfileValue","setUserProfile","hideVisibleMessage","filename","ended_at","sendBeacon","clipJSON","request","emptyEvents","error","startsWith","propertyKeys","keys","propertyKey","null","babelHelpers.extends","innerHeight","innerWidth","location","host","connection","effectiveType","Notification","permission","reproio","pathname","links","currentTarget","href","pushState","history","state","hideMessage"],"mappings":"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"}